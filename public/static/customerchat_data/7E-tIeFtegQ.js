if (self.CavalryLogger) { CavalryLogger.start_js(["zHiSb"]); }

__d("AsyncUploadBase",["ArbiterMixin","AsyncRequest","AsyncResponse","BrowserSupport","Form","forEachObject","mixin","removeFromArray"],(function(a,b,c,d,e,f){a=function(a){babelHelpers.inheritsLoose(c,a);c.parseFiles=function(a){var c={};b("forEachObject")(a,function(a,b){if(Array.isArray(a))c[b]=a;else{c[b]=[];if(a instanceof window.FileList)for(var d=0;d<a.length;d++)c[b].push(a.item(d));else(a instanceof window.File||a instanceof window.Blob)&&c[b].push(a)}});return c};function c(b){var c;c=a.call(this)||this;c._allowCrossOrigin=!1;c._allowCrossPageTransition=!1;c._customHeader={};c._inFlight=!1;c._limit=10;c._option={};c._preventDefaultErrorHandler=!1;c._suspended=!1;b&&c.setURI(b);c.setNetworkErrorRetryLimit(0);return c}var d=c.prototype;d.setAllowCrossOrigin=function(a){this._allowCrossOrigin=!!a;return this};d.setAllowCrossPageTransition=function(a){this._allowCrossPageTransition=!!a;return this};d.setCustomHttpHeader=function(a,b){this._customHeader[a]=b;return this};d.setData=function(a){this._data=a;return this};d.setOption=function(a,b){this._option[a]=b;return this};d.setPreventDefaultErrorHandler=function(a){this._preventDefaultErrorHandler=a;return this};d.setLimit=function(a){this._limit=a;return this};d.setNetworkErrorRetryLimit=function(a){this._retryLimit=a;return this};d.setPreprocessHandler=function(a){this._preprocessHandler=a;return this};d.setRelativeTo=function(a){this._relativeTo=a;return this};d.setStatusElement=function(a){this._statusElement=a;return this};d.setURI=function(a){this._uri=a;return this};d.suspend=function(){this._suspended=!0;return this};d.resume=function(){this._suspended=!1;this._processQueue();return this};d.isUploading=function(){return this._inFlight};d._createFileUpload=function(a,b,c){return new g(a,b,c)};d._processQueue=function(){if(this._suspended)return;while(this._pending.length<this._limit){if(!this._waiting.length)break;var a=this._waiting.shift(),b=this._preprocessHandler;b?b(a,this._processUpload.bind(this)):this._processUpload(a);this._pending.push(a)}};d._processUpload=function(a){var c=b("Form").createFormData(a.getData()||this._data);if(a.getFile()){c.append(a.getName(),a.getFile());var d=a.getFile().uploadID;d&&c.append("upload_id",d);a.getAdditionalData().forEach(function(a,b){return c.append(b,a)})}d=new(b("AsyncRequest"))().setAllowCrossOrigin(this._allowCrossOrigin).setAllowCrossPageTransition(this._allowCrossPageTransition).setURI(this._uri).setRawData(c).setStatusElement(this._statusElement).setHandler(this._success.bind(this,a)).setErrorHandler(this._failure.bind(this,a)).setUploadProgressHandler(this._progress.bind(this,a)).setInitialHandler(this._initial.bind(this,a));for(var e in this._option)d.setOption(e,this._option[e]);for(var f in this._customHeader)d.setRequestHeader(f,this._customHeader[f]);this._relativeTo&&d.setRelativeTo(this._relativeTo);d.send();a.setAsyncRequest(d);this._inFlight=!0;a.getRetryCount()||this.inform("start",a)};d._abort=function(a){this._pending.indexOf(a)!==-1&&(b("removeFromArray")(this._pending,a),this._processQueue()),b("removeFromArray")(this._waiting,a),a.abort()};d._initial=function(a){if(a.isAborted())return;this.inform("initial",a)};d._success=function(a,b){if(a.isAborted()){this.inform("success_after_abort",b);return}this._complete(a);this.inform("success",a.handleSuccess(b));this._processQueue()};d._retryUpload=function(a){a.increaseRetryCount(),this._processUpload(a)};d._failure=function(a,c){if(a.isAborted())return;if(c.error===1004&&a.getRetryCount()<(this._retryLimit||0))return this._retryUpload(a);this._complete(a);this.inform("failure",a.handleFailure(c))!==!1&&(this._preventDefaultErrorHandler||b("AsyncResponse").defaultErrorHandler(c));this._processQueue()};d._progress=function(a,b){if(a.isAborted())return;this.inform("progress",a.handleProgress(b))};d._complete=function(a){b("removeFromArray")(this._pending,a),this._pending.length||(this._inFlight=!1)};c.isSupported=function(){return b("BrowserSupport").hasFileAPI()};return c}(b("mixin")(b("ArbiterMixin")));e.exports=a;var g=function(){function a(a,b,c){this._additionalData=new Map(),this._success=null,this._response=null,this._progressEvent=null,this._request=null,this._numRetries=0,this._aborted=!1,this._name=a,this._file=b,this._data=c}var b=a.prototype;b.getName=function(){return this._name};b.getFile=function(){return this._file};b.setFile=function(a){this._file=a};b.getData=function(){return this._data};b.getAdditionalData=function(){return this._additionalData};b.isComplete=function(){return this._success!==null};b.isSuccess=function(){return this._success===!0};b.getResponse=function(){return this._response};b.getProgressEvent=function(){return this._progressEvent};b.setAsyncRequest=function(a){this._request=a;return this};b.increaseRetryCount=function(){this._numRetries++;return this};b.getRetryCount=function(){return this._numRetries};b.isWaiting=function(){return!this._request};b.isAborted=function(){return this._aborted};b.abort=function(){this._request=null,this._aborted=!0};b.handleSuccess=function(a){this._success=!0;this._response=a;this._progressEvent=null;return this};b.handleFailure=function(a){this._success=!1;this._response=a;this._progressEvent=null;return this};b.handleProgress=function(a){this._progressEvent=a;return this};return a}()}),null);
__d("AsyncUploadRequest",["AsyncUploadBase"],(function(a,b,c,d,e,f){a=function(a){babelHelpers.inheritsLoose(c,a);function c(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c._files=null,c._uploads=[],c._fileLessUpload=null,b)||babelHelpers.assertThisInitialized(c)}var d=c.prototype;d.setFiles=function(a){this._files=b("AsyncUploadBase").parseFiles(a);return this};d.setAlwaysReturnResponse=function(a){this._shouldAlwaysReturnResponse=a};d.abort=function(){var a=this;this._uploads.forEach(function(b){return a._abort(b)},this)};d.send=function(){if(this._inFlight)return;this._inFlight=!0;this._uploads=[];for(var a in this._files)this._files[a].forEach(function(b){this._uploads.push(this._createFileUpload(a,b))}.bind(this));this._waiting=this._uploads.slice(0);this._pending=[];this._uploads.length?this._processQueue():(this._fileLessUpload=this._createFileUpload(null,null),this._processUpload(this._fileLessUpload))};d._processQueue=function(){a.prototype._processQueue.call(this);if(!this._pending.length&&!this._waiting.length){var b=this._uploads;b=this._shouldAlwaysReturnResponse?this._fileLessUpload!=null?{response:this._fileLessUpload.getResponse(),uploads:b}:{response:b[0].getResponse(),uploads:b}:b;this.inform("complete",b)}};c.isSupported=function(){return b("AsyncUploadBase").isSupported()};return c}(b("AsyncUploadBase"));e.exports=a}),null);
__d("FileForm",["ArbiterMixin","AsyncRequest","AsyncResponse","AsyncUploadRequest","BehaviorsMixin","CurrentUser","DataStore","DOMQuery","Event","Form","JSONPTransport","Parent","URI","isElementNode","mixin","setTimeout","shield"],(function(a,b,c,d,e,f){var g;function h(a){var c={};a=b("DOMQuery").scry(a,'input[type="file"]');a.forEach(function(a){c[a.name]=a.files});return c}function i(a){a=b("DOMQuery").scry(a,'input[type="file"]');a.forEach(function(a){a.files=null})}a=function(a){babelHelpers.inheritsLoose(c,a);function c(c,d,e){var f;f=a.call(this)||this;f._handleSubmit=function(a){if(a.isDefaultPrevented()||a.getTarget()!==f._form)return;if(f.inform("submit")===!1){a.prevent();return}f.submit(a)};f.initial=function(a){return f.inform("initial",{upload:a})};if(c.getAttribute("rel")==="async")throw new Error("FileForm cannot be used with Primer forms.");if((c.getAttribute("method")||"").toUpperCase()!=="POST")throw new Error("FileForm must be used with POST forms.");f._form=c;f._previousEncoding=f._form.enctype;f._form.enctype=f._form.encoding="multipart/form-data";f._files=null;f._customHeader={};d&&f.enableBehaviors(d);f._options=e||{};f.setAllowCrossOrigin(f._options.allowCrossOrigin);f.setAllowCrossPageTransition(f._options.allowCrossPageTransition);f.setUploadInParallel(f._options.uploadInParallel);f.setConcurrentLimit(f._options.concurrentLimit);f.setPreprocessHandler(f._options.preprocessHandler);f.setNetworkErrorRetryLimit(f._options.networkErrorRetryLimit);f._listeners=[b("Event").listen(document.documentElement,"submit",f._handleSubmit),b("Event").listen(f._form,"click",f._click.bind(babelHelpers.assertThisInitialized(f)))];b("DataStore").set(f._form,"FileForm",babelHelpers.assertThisInitialized(f));return f}var d=c.prototype;d.getRoot=function(){return this._form};d.setAllowCrossOrigin=function(a){this._allowCrossOrigin=!!a;return this};d.setAllowCrossPageTransition=function(a){this._allowCrossPageTransition=!!a;return this};d.setUploadInParallel=function(a){this._uploadInParallel=!!a;return this};d.setConcurrentLimit=function(a){this._concurrentLimit=a;return this};d.setCustomHttpHeader=function(a,b){this._customHeader[a]=b;return this};d.setPreprocessHandler=function(a){this._preprocessHandler=a;return this};d.setNetworkErrorRetryLimit=function(a){this._retryLimit=a;return this};d.setFiles=function(a){this._files=a;return this};d.canUseXHR=function(){var a="FormData"in window;a&&(!new(g||(g=b("URI")))(this._form.action).isSameOrigin()&&!this._allowCrossOrigin&&(a=!1));return a};d._click=function(a){a=a.getTarget();while(b("isElementNode")(a)){if(a.type==="submit"){this._clickTarget=a;b("setTimeout")(this._unclick.bind(this),0);break}a=a.parentNode}};d._unclick=function(){this._clickTarget=null};d._sendViaFrame=function(){var a=this._request=new(b("AsyncRequest"))();a.setStatusElement(this._getStatusElement());a.addStatusIndicator();a.setOption("useIframeTransport",!0);var c=a.handleResponse.bind(a);c=new(b("JSONPTransport"))("iframe",this._form.action,c);var d=c.getTransportFrame(),e=c.getRequestURI().addQueryData({__iframe:!0,__user:b("CurrentUser").getID()});this._form.setAttribute("action",e.toString());c.createContinuationForFileForm_DO_NOT_USE();this._form.setAttribute("target",d.name);a.setJSONPTransport(c);a.setURI(e);a.setHandler(this.success.bind(this,null));a.setErrorHandler(this.failure.bind(this,null));a.setInitialHandler(b("shield")(this.initial,this,null))};d._sendViaXHR=function(a){var c=this,d;if(this._uploadInParallel&&b("AsyncUploadRequest").isSupported()){d=new(b("AsyncUploadRequest"))().setPreprocessHandler(this._preprocessHandler).setData(b("Form").serialize(this._form,this._clickTarget)).setNetworkErrorRetryLimit(this._retryLimit);for(var e in this._customHeader)d.setCustomHttpHeader(e,this._customHeader[e]);this._concurrentLimit&&d.setLimit(this._concurrentLimit);this._files?d.setFiles(this._files):d.setFiles(h(this._form));var f=[d.subscribe("progress",function(a,b){this.progress(b,b.getProgressEvent())}.bind(this)),d.subscribe("initial",function(a,b){this.initial(b)}.bind(this)),d.subscribe("success",function(a,b){this.success(b,b.getResponse())}.bind(this)),d.subscribe("start",function(a,b){this.inform("start",{upload:b})}.bind(this)),d.subscribe("failure",function(a,b){this.failure(b,b.getResponse());return!1}.bind(this)),d.subscribe("complete",function(){while(f.length)f.pop().unsubscribe()})]}else{var g,e,i;(function(){var a,f=c._files;if(f){a=b("Form").createFormData(b("Form").serialize(c._form,c._clickTarget));g=b("AsyncUploadRequest").parseFiles(f);for(e in g)i=g[e],i.length===1?a.append(e,i[0]):(e=e+"[]",i.forEach(function(b){a.append(e,b)}))}else a=b("Form").createFormData(c._form,c._clickTarget);d=new(b("AsyncRequest"))().setRawData(a).setHandler(c.success.bind(c,null)).setErrorHandler(c.failure.bind(c,null)).setUploadProgressHandler(c.progress.bind(c,null)).setInitialHandler(b("shield")(c.initial,c,null));c.inform("start",{upload:null})})()}d.setAllowCrossOrigin(this._allowCrossOrigin).setAllowCrossPageTransition(this._allowCrossPageTransition).setRelativeTo(this._form).setStatusElement(this._getStatusElement()).setURI(this._form.action).send();this._request=d;a&&a.prevent()};d.forceSendViaXHR=function(){return this._sendViaXHR(null)};d.success=function(a,c){c={response:c,upload:a};this.inform("success",c)!==!1&&b("Event").fire(this._form,"success",c);this._cleanup()};d.failure=function(a,c){a={response:c,upload:a};this.inform("failure",a)!==!1&&(b("Event").fire(this._form,"error",a)!==!1&&b("AsyncResponse").defaultErrorHandler(c));this._cleanup()};d.progress=function(a,b){this.inform("progress",{event:b,upload:a})};d.abort=function(){this._request&&(this._request.abort(),this._cleanup())};d.clear=function(){i(this._form)};d.destroy=function(){this._cleanup();while(this._listeners&&this._listeners.length)this._listeners.pop().remove();this._listeners=null;this._form.enctype=this._form.encoding=this._previousEncoding;b("DataStore").remove(this._form,"FileForm")};d.submit=function(a){this.canUseXHR()?this._sendViaXHR(a):this._sendViaFrame()};d._cleanup=function(){this._request=null};d._getStatusElement=function(){return b("Parent").byClass(this._form,"stat_elem")||this._form};c.getInstance=function(a){return b("DataStore").get(a,"FileForm")};return c}(b("mixin")(b("ArbiterMixin"),b("BehaviorsMixin")));e.exports=a;Object.assign(a,{EVENTS:["start","submit","initial","progress","success","failure"]})}),null);
__d("PhotosUploadID",[],(function(a,b,c,d,e,f){f.getNewID=a;var g=1024;function a(){return(g++).toString()}}),null);
__d("LiveChatPluginMessageComposerAttachmentItem.react",["cx","ix","Image.react","React","ShimButton.react"],(function(a,b,c,d,e,f,g,h){"use strict";var i=b("React");a=function(a){babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.render=function(){var a=this.props.attachment;if(a.type.startsWith("image/"))return[i.jsx("div",{className:"_3l_i",style:{backgroundImage:a.thumbnail_url}},this.props.uploadID+"item"),i.jsx(b("ShimButton.react"),{className:"_3l_j _3l_k",onClick:this.props.removeAttachment},this.props.uploadID+"removeButton")];var c=i.jsx("div",{className:"_3l_l",style:{backgroundColor:this.props.threadColor},children:i.jsx(b("Image.react"),{src:a.type.startsWith("video/")?h("359148"):h("359146")})});a=a.name;var d=a.split(".").pop().toUpperCase();return i.jsxs("div",{className:"_3l_m",children:[c,i.jsxs("div",{className:"_3l_n",children:[i.jsx("div",{className:"_3l_o",children:d}),i.jsx("div",{className:"_3l_p",children:a})]}),i.jsx(b("ShimButton.react"),{className:"_3l_j _3l_q",onClick:this.props.removeAttachment})]})};return c}(i.PureComponent);e.exports=a}),null);
__d("LiveChatPluginMessageComposerAttachmentShelf.react",["cx","fbt","LiveChatPluginAttachmentUploadError","LiveChatPluginMessageComposerAttachmentItem.react","React","XUISpinner.react"],(function(a,b,c,d,e,f,g,h){"use strict";var i=b("React");a=function(a){babelHelpers.inheritsLoose(c,a);function c(b){b=a.call(this,b)||this;b.$1=new Map();return b}var d=c.prototype;d.render=function(){var a=this;if(this.props.attachments.size===0&&this.props.error===b("LiveChatPluginAttachmentUploadError").NO_ERROR)return null;this.props.attachments.forEach(function(b,c){a.$1.has(c)||a.$1.set(c,b)});this.$1.forEach(function(b,c){a.props.attachments.has(c)||a.$1["delete"](c)});var c=Array.from(this.$1).map(function(c){var d=c[0];c=c[1];return i.jsxs("div",{className:"_1i5v",children:[i.jsx(b("LiveChatPluginMessageComposerAttachmentItem.react"),{attachment:c,removeAttachment:function(){a.props.removeAttachment(d)},threadColor:a.props.threadColor,uploadID:d}),a.props.uploadingAttachments.has(d)?i.jsx(b("XUISpinner.react"),{className:"_1i63",background:"dark",size:"large"}):null]},d)});return i.jsxs("div",{className:"_1i69",children:[this.$2(),i.jsx("div",{className:"_2l9u",children:c})]})};d.$2=function(){var a;switch(this.props.error){case b("LiveChatPluginAttachmentUploadError").EXCEEDED_MAX_FILES:a=h._("Upload no more than 5 files at once. Please try again.");break;case b("LiveChatPluginAttachmentUploadError").EXCEEDED_FILE_MAX_SIZE:a=h._("This file exceeds the size limit of 25MB.");break;case b("LiveChatPluginAttachmentUploadError").UPLOAD_FAILED:a=h._("This file couldn't be uploaded. Please try again.");break;case b("LiveChatPluginAttachmentUploadError").NO_ERROR:default:return null}return i.jsx("div",{className:"_2l9v",children:a})};return c}(i.PureComponent);e.exports=a}),null);
__d("MPNBlockedPageComposer.react",["cx","fbt","MessagingPluginContext","MessagingPluginThreadActions","React","ShimButton.react"],(function(a,b,c,d,e,f,g,h){"use strict";e.exports=a;var i=b("React");function a(){var a=i.useContext(b("MessagingPluginContext"));return i.jsx("div",{className:"_94wl",children:i.jsxs("div",{className:"_94wm",children:[i.jsx("div",{children:h._("\u0412\u044b \u0432\u044b\u043a\u043b\u044e\u0447\u0438\u043b\u0438 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f \u0434\u043b\u044f \u0421\u0442\u0440\u0430\u043d\u0438\u0446\u044b {pageName}",[h._param("pageName",a.state.pageName)])}),h._("\u0412\u044b \u043d\u0435 \u043c\u043e\u0436\u0435\u0442\u0435 \u043e\u0431\u043c\u0435\u043d\u0438\u0432\u0430\u0442\u044c\u0441\u044f \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f\u043c\u0438 \u0441 \u044d\u0442\u043e\u0439 \u0421\u0442\u0440\u0430\u043d\u0438\u0446\u0435\u0439."),i.jsx(b("ShimButton.react"),{className:"_94wo",onClick:function(){b("MessagingPluginThreadActions").blockOrUnblockPage(a)},children:i.jsx("div",{className:"_94wp",children:h._("\u0412\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f")})})]})})}}),null);
__d("XMNLiveChatPluginFileUploadController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/plugins/live_chat/upload/",{})}),null);
__d("LiveChatPluginAttachmentUploadClient",["FileForm","LiveChatPluginAttachmentUploadError","LiveChatPluginLoggerUtil","MercuryConstants","PhotosUploadID","SubscriptionsHandler","XMNLiveChatPluginFileUploadController","cssURL"],(function(a,b,c,d,e,f){"use strict";var g=5;a=function(){function a(a,c,d,e){var f=this;this.$14=function(a,b){((a=b)!=null?(a=a.response)!=null?(a=a.payload)!=null?a.result:a:a:a)==="success"?f.$22(b):f.$23(b)};this.$1=new Map();this.$2=new Map();this.$3=new Map();this.$4=new Map();this.$5=d;this.$6=c;this.$7=new(b("SubscriptionsHandler"))();this.$8=a;this.$9=new Set();this.$10=new Map();this.$11=e}var c=a.prototype;c.onSubmitFileList=function(a){this.$6(b("LiveChatPluginAttachmentUploadError").NO_ERROR);var c=this.$12();c=this.$13(c);this.$7.addSubscriptions(c.subscribe("success",this.$14));if(a){if(a.length+this.$2.size>g){this.$6(b("LiveChatPluginAttachmentUploadError").EXCEEDED_MAX_FILES);b("LiveChatPluginLoggerUtil").logAction("customer_chat_attachment_upload_failed",this.$11,this.$5,JSON.stringify({error:"exceeded_max_files"}));return}var d={};for(var e=0;e<a.length;e++){var f=a[e];if(f.size>b("MercuryConstants").AttachmentMaxSize){this.$6(b("LiveChatPluginAttachmentUploadError").EXCEEDED_FILE_MAX_SIZE);b("LiveChatPluginLoggerUtil").logAction("customer_chat_attachment_upload_failed",this.$11,this.$5,JSON.stringify({error:"exceeded_max_file_size"}));return}var h=this.$15();d[h]=f;this.$9.add(h);this.$2.set(h,{name:f.name,thumbnail_url:b("cssURL")(window.URL.createObjectURL(f)),type:f.type});b("LiveChatPluginLoggerUtil").logAction("customer_chat_attachment_upload_submitted",this.$11,this.$5,JSON.stringify({uploadID:h}))}c.setFiles(d);c.forceSendViaXHR()}this.$8(this.$16(),this.$17())};c.removeAttachment=function(a){this.$9["delete"](a),this.$1["delete"](a),this.$2["delete"](a),this.$4["delete"](a),this.$3["delete"](a),this.$10["delete"](a),this.$8(this.$16(),this.$17(),this.$18(),this.$19(),this.$20(),this.$21()),b("LiveChatPluginLoggerUtil").logAction("customer_chat_attachment_upload_removed",this.$11,this.$5,JSON.stringify({uploadID:a}))};c.removeAllAttachments=function(){this.$1=new Map(),this.$2=new Map(),this.$3=new Map(),this.$4=new Map(),this.$9=new Set(),this.$10=new Map(),this.$8(this.$16(),this.$17(),this.$18(),this.$19(),this.$20(),this.$21())};c.$22=function(a){var c=a.response.payload;a=a.upload.getName();c=c.metadata[0];this.$9.has(a)&&(this.$9["delete"](a),c.image_id?this.$4.set(a,c.image_id):c.gif_id?this.$1.set(a,c.gif_id):c.video_id?this.$10.set(a,c.video_id):this.$3.set(a,c.file_id),this.$8(this.$16(),this.$17()),b("LiveChatPluginLoggerUtil").logAction("customer_chat_attachment_upload_completed",this.$11,this.$5,JSON.stringify({uploadID:a})));this.$24()||this.$8(this.$16(),this.$17(),this.$18(),this.$19(),this.$20(),this.$21())};c.$23=function(a){this.removeAttachment(a.upload.getName()),this.$6(b("LiveChatPluginAttachmentUploadError").UPLOAD_FAILED),b("LiveChatPluginLoggerUtil").logAction("customer_chat_attachment_upload_failed",this.$11,this.$5,JSON.stringify({error:"upload_failed"}))};c.$20=function(){return this.$4.size===0?[]:Array.from(this.$4.values())};c.$18=function(){return this.$1.size===0?[]:Array.from(this.$1.values())};c.$21=function(){return this.$10.size===0?[]:Array.from(this.$10.values())};c.$19=function(){return this.$3.size===0?[]:Array.from(this.$3.values())};c.$24=function(){return this.$9.size!==0};c.$16=function(){return this.$2};c.$17=function(){return this.$9};c.$12=function(){var a=document.createElement("form");a.action=b("XMNLiveChatPluginFileUploadController").getURIBuilder().getURI().toString();a.method="post";return a};c.$13=function(a){a=new(b("FileForm"))(a);a.setAllowCrossOrigin(!0);a.setUploadInParallel(!0);return a};c.$15=function(){return"upload_"+b("PhotosUploadID").getNewID()};c.destroy=function(){this.$7.release(),delete this.$7};return a}();e.exports=a}),null);
__d("MPNDesktopAttachmentInput.react",["cx","InlineBlock.react","LiveChatPluginAttachmentUploadClient","LiveChatPluginLoggerUtil","MessagingPluginContext","MPNPaperclipIconSVG.react","React"],(function(a,b,c,d,e,f,g){"use strict";var h=b("React");a=function(a){babelHelpers.inheritsLoose(c,a);function c(){var c,d;for(var e=arguments.length,f=new Array(e),g=0;g<e;g++)f[g]=arguments[g];return(c=d=a.call.apply(a,[this].concat(f))||this,d.$2=function(){var a=d.context.state.pageID;b("LiveChatPluginLoggerUtil").logActionFromNewUI("in_thread_action",d.props.viewerID,a,"logged_in_chat_tab",{action_type:"customer_chat_attachment_button_clicked"})},c)||babelHelpers.assertThisInitialized(d)}var d=c.prototype;d.componentDidMount=function(){this.$1=new(b("LiveChatPluginAttachmentUploadClient"))(this.props.updateComposerAttachmentsAndIDs,this.props.setComposerAttachmentError,this.props.pageID,this.props.viewerID)};d.componentWillUnmount=function(){this.$1.destroy()};d.render=function(){var a=this;return h.jsxs(b("InlineBlock.react"),{className:"_95jj",onClick:this.$2,children:[h.jsx("input",{accept:"application/msword, application/pdf, text/csv, text/plain, image/*, video/*",className:"_94vw",multiple:!0,name:"attachment[]",onChange:function(b){a.$3(b)},ref:"fileInput",title:"Add Files",type:"file"}),h.jsx(b("MPNPaperclipIconSVG.react"),{color:this.context.state.threadCSSColor})]})};d.$3=function(a){this.$1.onSubmitFileList(a.target.files),a.target.value=""};d.removeAttachment=function(a){this.$1.removeAttachment(a)};d.removeAllAttachments=function(){this.$1.removeAllAttachments()};return c}(h.PureComponent);e.exports=a;a.contextType=b("MessagingPluginContext")}),null);
__d("MPNDesktopBotMenuDialog.react",["cx","CometMenu.react","CometMenuItem.react","LiveChatPluginLoggerUtil","MercuryIDs","MessagingPluginContext","MNCommercePostbackCTADataManager","MPNIdentity","React","URI"],(function(a,b,c,d,e,f,g){"use strict";var h,i=b("React");a=function(a){babelHelpers.inheritsLoose(c,a);function c(c,d){c=a.call(this,c,d)||this;c.state={navigationPath:[]};c.$1=b("LiveChatPluginLoggerUtil").getAttributionTags();c.$2=b("MercuryIDs").getThreadIDFromUserID(c.context.state.pageID);return c}var d=c.prototype;d.render=function(){var a=this,c=[],d=this.props.menuItems;for(var e=0;e<this.state.navigationPath.length;e++){var f=this.state.navigationPath[e];d!=null&&(d=d[f].nested_ctas)}d&&d.map(function(d,b){switch(d.action_type){case 4:a.$3(d,c);break;case 2:a.$4(d,c);break;case 11:a.$5(d,b,c);break;default:c.push({menuItemProps:{primaryText:d.title||""}});break}});return i.jsx("div",{className:"_968x",children:i.jsx(b("CometMenu.react"),{size:"full",withArrow:!0,children:c.map(function(c,a){return i.createElement(b("CometMenuItem.react"),babelHelpers["extends"]({},c.menuItemProps,{key:a}))})})})};d.$4=function(a,c){var d=this.context.state.pageID,e=function(c){(h||(h=b("URI"))).goURIOnNewWindow(a.action_link||"");c=b("MPNIdentity").MPNIdentity.currentUserID();b("LiveChatPluginLoggerUtil").logActionFromNewUI("in_thread_action",c,d,b("MPNIdentity").MPNIdentity.currentUserState()===b("MPNIdentity").MPNIdentityState.FB?"logged_in_chat_tab":"guest_chat_tab",{action_type:"customer_chat_bot_menu_url_redirect_clicked"})};c.push({menuItemProps:{onClick:e,primaryText:a.title||""}})};d.$5=function(a,b,c){var d=this,e=function(a){d.setState(function(a){return{navigationPath:a.navigationPath.concat(b)}})};c.push({menuItemProps:{onClick:e,primaryText:a.title||""}})};d.$3=function(a,c){var d=this,e=this.context.state.pageID,f=function(c){c=b("MPNIdentity").MPNIdentity.currentUserState();switch(c){case b("MPNIdentity").MPNIdentityState.FB:b("MNCommercePostbackCTADataManager").sendAndConfirm(a.id,a.title||"",d.$2,null,null,null,d.$1,null,null,"source:discovery:customer_chat_plugin");break;case b("MPNIdentity").MPNIdentityState.GUEST:var f=d.context.state.messageStore;f=f.sendQueue;if(!f)return;f.enqueueAndSend(a.title||"",f.makePlatformTokenForPostbackCTA(a.id));break;default:return}f=b("MPNIdentity").MPNIdentity.currentUserID();b("LiveChatPluginLoggerUtil").logActionFromNewUI("in_thread_action",f,e,c===b("MPNIdentity").MPNIdentityState.FB?"logged_in_chat_tab":"guest_chat_tab",{action_type:"customer_chat_bot_menu_postback_clicked"})};c.push({menuItemProps:{onClick:f,primaryText:a.title||""}})};return c}(i.Component);e.exports=a;a.contextType=b("MessagingPluginContext")}),null);
__d("MPNDesktopBotMenuButton.react",["cx","fbt","AsyncRequest","BasePopoverTrigger.react","CometPressable.react","LiveChatPluginConstants","LiveChatPluginGuestPersistentMenuQuery","LiveChatPluginLoggerUtil","LiveChatPluginSendButtonSVG.react","MessagingPluginContext","MPNBotMenuButtonSVG.react","MPNDesktopBotMenuDialog.react","MPNIdentity","MPNLocalState","MPNStorage","React","XMessengerBotsMenuController"],(function(a,b,c,d,e,f,g,h){"use strict";var i=b("React");a=function(a){babelHelpers.inheritsLoose(c,a);function c(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.state={menuItems:null},c.$4=function(){c.setState(c.$3(!0)),c.props.onClick()},b)||babelHelpers.assertThisInitialized(c)}var d=c.prototype;d.UNSAFE_componentWillMount=function(){this.state.menuItems==null&&this.$2()};d.componentDidUpdate=function(){this.state.menuItems==null&&this.context.state.accessToken&&this.$2()};d.componentWillUnmount=function(){this.$1&&(this.$1.abort(),this.$1=null),this.setState(this.$3(!1))};d.render=function(){var a=this,c=this.context.state,d=c.isComposerDisabled,e=c.hasPersistentMenu,f=c.threadCSSColor;return!d&&(!e||!this.state.menuItems)?i.jsx("div",{className:" _95jk _95ms",children:i.jsx(b("LiveChatPluginSendButtonSVG.react"),{threadColor:b("LiveChatPluginConstants").GUEST_SEND_BUTTON_COLOR_EMPTY_INPUT})}):i.jsx(b("BasePopoverTrigger.react"),{autoAlign:!0,popover:b("MPNDesktopBotMenuDialog.react"),popoverProps:{menuItems:this.state.menuItems},children:function(c,d){return i.jsx("div",{ref:c,children:i.jsx("div",{className:"_94vq",children:i.jsx(b("CometPressable.react"),{overlayRadius:50,"aria-label":h._("\u041f\u043e\u0441\u0442\u043e\u044f\u043d\u043d\u043e\u0435 \u043c\u0435\u043d\u044e"),onPress:(a.$4,d),children:i.jsx(b("MPNBotMenuButtonSVG.react"),{threadColor:f})})})})}})};d.$2=function(){var a=this,c=this.context,d=c.state,e=c.dispatchAction;c=d.pageID;d=b("MPNStorage").getFBStorageState();if(!d||d.chatState===b("MPNLocalState").MPNChatState.CHAT_NOT_STARTED)return;d=b("MPNIdentity").MPNIdentity.currentUserState();switch(d){case b("MPNIdentity").MPNIdentityState.GUEST:d=(d=b("MPNIdentity").MPNIdentity.currentUser())==null?void 0:d.accessToken;if(d==null)return;b("LiveChatPluginGuestPersistentMenuQuery").fetch(c,d,function(b){b!=null&&b.length>0?(a.setState({menuItems:b}),e({type:"TOGGLE_HAS_PERSISTENT_MENU",hasPersistentMenu:!0})):(a.setState({menuItems:[]}),e({type:"TOGGLE_HAS_PERSISTENT_MENU",hasPersistentMenu:!1}))});break;case b("MPNIdentity").MPNIdentityState.FB:d=b("XMessengerBotsMenuController").getURIBuilder().setString("page_id",c).setBool("should_flatten",!0).getURI();this.$1=new(b("AsyncRequest"))().setURI(d).setHandler(function(b){a.setState({menuItems:b.payload.menu})}).setErrorHandler(function(b){a.setState({menuItems:[]})});this.$1.send();break;default:return}};d.$3=function(a){var c=this.context.state.pageID,d=b("MPNIdentity").MPNIdentity.currentUserID();b("LiveChatPluginLoggerUtil").logActionFromNewUI("in_thread_action",d,c,b("MPNIdentity").MPNIdentity.currentUserState()===b("MPNIdentity").MPNIdentityState.FB?"logged_in_chat_tab":"guest_chat_tab",{action_type:a?"customer_chat_bot_menu_opened":"customer_chat_bot_menu_closed"})};return c}(i.Component);e.exports=a;a.contextType=b("MessagingPluginContext")}),null);
__d("MessagingPluginDesktopProfilePicture.react",["cx","Image.react","MessagingPluginContext","PrivacyTransparentOverlay.react","React"],(function(a,b,c,d,e,f,g){"use strict";var h=b("React");a=function(a){babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.render=function(){var a=this.context.state,c=a.pageProfilePictureUri;a=a.isBusinessActive;var d=this.props,e=d.className;d=d.greenDotSize;d=d==="large"?"_95lb _97p-":"_95lb _97ot";return h.jsxs(b("PrivacyTransparentOverlay.react"),{children:[h.jsx(b("Image.react"),{className:(e=e)!=null?e:"_95la",src:c}),a?h.jsx("div",{className:d}):null]})};return c}(h.Component);e.exports=a;a.contextType=b("MessagingPluginContext")}),null);
__d("MessagingPluginDesktopThreadMenu.react",["cx","fbt","CometMenu.react","CometMenuItem.react","CometSeparatorMenuItem.react","MessagingPluginContext","MessagingPluginThreadActions","MPNIdentity","React","URI"],(function(a,b,c,d,e,f,g,h){"use strict";e.exports=a;var i,j=b("React");function a(a){var c=j.useContext(b("MessagingPluginContext")),d=c.state,e=d.pageID,f=d.isPageBlocked,g=d.locale;d=d.showUpgradeUpsellPrompt;var k=b("MPNIdentity").MPNIdentity.currentUserState()===b("MPNIdentity").MPNIdentityState.GUEST;return j.jsx("div",{className:"_968x",children:j.jsxs(b("CometMenu.react"),{size:"full",withArrow:!0,children:[k&&d?j.jsx(b("CometMenuItem.react"),{icon:{src:"/images/web_messenger/app-messenger_32-4x.png",style:"square"},iconStyle:"normal",onClick:function(){return a.onUpgrade()},primaryText:h._("\u041f\u0435\u0440\u0435\u0439\u0442\u0438 \u0432 Messenger")}):null,j.jsx(b("CometMenuItem.react"),{icon:{src:"/images/web_messenger/cross-circle_32-4x.png",style:"square"},onClick:function(){c.dispatchAction({type:"TOGGLE_END_CHAT",showEndChat:!0})},primaryText:h._("\u0417\u0430\u0432\u0435\u0440\u0448\u0438\u0442\u044c \u0447\u0430\u0442")}),!k&&f!=null?j.jsx(b("CometMenuItem.react"),{icon:{src:"/images/web_messenger/message-cross_32-4x.png",style:"square"},iconStyle:"normal",onClick:function(){b("MessagingPluginThreadActions").blockOrUnblockPage(c)},primaryText:f?h._("\u0412\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f"):h._("\u0412\u044b\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f")}):null,k?null:j.jsx(b("CometMenuItem.react"),{icon:{src:"/images/web_messenger/bell-cross_32-4x.png",style:"square"},iconStyle:"normal",onClick:a.onClickMuteOrUnmute,primaryText:a.isMuted?h._("Unmute Conversation"):h._("\u0412\u0440\u0435\u043c\u0435\u043d\u043d\u043e \u0437\u0430\u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0435\u0440\u0435\u043f\u0438\u0441\u043a\u0443")}),j.jsx(b("CometMenuItem.react"),{icon:{src:"/images/web_messenger/caution-triangle_32-4x.png",style:"square"},iconStyle:"normal",onClick:function(){b("MessagingPluginThreadActions").openFRXPrompt(e,g)},primaryText:h._("\u0421\u043e\u043e\u0431\u0449\u0438\u0442\u044c \u043e \u043d\u0430\u0440\u0443\u0448\u0435\u043d\u0438\u0438")}),j.jsx(b("CometSeparatorMenuItem.react"),{}),j.jsx(b("CometMenuItem.react"),{onClick:function(){(i||(i=b("URI"))).goURIOnNewWindow("https://www.facebook.com/"+e)},primaryText:h._("\u041f\u043e\u0441\u0435\u0442\u0438\u0442\u044c \u0421\u0442\u0440\u0430\u043d\u0438\u0446\u0443 Facebook")}),j.jsx(b("CometMenuItem.react"),{onClick:function(){(i||(i=b("URI"))).goURIOnNewWindow("https://www.facebook.com/business/m/add-messenger-to-your-website")},primaryText:h._("\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c Messenger \u043d\u0430 \u0441\u0432\u043e\u0439 \u0441\u0430\u0439\u0442")})]})})}}),null);
__d("MPNDesktopDialogHeader.react",["ix","cx","fbt","Arbiter","BasePopoverTrigger.react","Image.react","LineClamp.react","LiveChatPluginLoggerUtil","MessagingPluginContext","MessagingPluginDesktopProfilePicture.react","MessagingPluginDesktopThreadMenu.react","MessagingPluginThreadActions","MPNConstants","MPNHeaderActionButton.react","MPNMoreInfoButtonSVG.react","React","asset","stylex"],(function(a,b,c,d,e,f,g,h,i){"use strict";var j,k=b("React");(j||(j=b("stylex"))).inject(".qmqpeqxj{border-top-left-radius:50%}",1,".qmqpeqxj{border-top-right-radius:50%}");j.inject(".e7u6y3za{border-top-right-radius:50%}",1,".e7u6y3za{border-top-left-radius:50%}");j.inject(".qwcclf47{border-bottom-right-radius:50%}",1,".qwcclf47{border-bottom-left-radius:50%}");j.inject(".nmlomj2f{border-bottom-left-radius:50%}",1,".nmlomj2f{border-bottom-right-radius:50%}");j.inject(".hpj0pwwo{font-size:1.0625rem}",1);j.inject(".igjjae4c{font-weight:bold}",1);j.inject(".mov749r8{color:var(--fds-black-alpha-50)}",1);j.inject(".nfkogyam{font-size:0.8125rem}",1);a=function(a){babelHelpers.inheritsLoose(c,a);function c(){var c,d;for(var e=arguments.length,f=new Array(e),g=0;g<e;g++)f[g]=arguments[g];return(c=d=a.call.apply(a,[this].concat(f))||this,d.$1=null,d.state={isMuted:d.context.state.isMuted},d.$3=function(){var a=d.context.state,c=a.guestID;a=a.pageID;d.$1=b("MessagingPluginThreadActions").launchUpgradeFlowDesktop(d.context,d.props.history,b("MPNConstants").MPNUpgradePrompt.CONTINUE_IN_MESSENGER);b("LiveChatPluginLoggerUtil").logActionFromNewUI("in_thread_action",c,a,"guest_chat_tab",{action_type:b("MPNConstants").MPNUpgradePrompt.CONTINUE_IN_MESSENGER})},d.$2=function(){var a=d.state.isMuted;b("MessagingPluginThreadActions").muteOrUnmutePage(d.context.state.pageID,a);d.setState({isMuted:!a})},c)||babelHelpers.assertThisInitialized(d)}var d=c.prototype;d.componentWillUnmount=function(){this.$1&&b("Arbiter").unsubscribe(this.$1)};d.render=function(){var a=this,c=this.context.state.pageName,d=this.props.menuEnabled!==!1;return k.jsxs("div",{className:"_9dxj",children:[k.jsx("div",{className:"nmlomj2f qwcclf47 e7u6y3za qmqpeqxj",children:k.jsx(b("MessagingPluginDesktopProfilePicture.react"),{})}),k.jsxs("div",{className:"_9dxi",children:[k.jsx(b("LineClamp.react"),{className:"igjjae4c hpj0pwwo",lines:1,children:k.jsx("strong",{children:c})}),k.jsx(b("LineClamp.react"),{className:"nfkogyam mov749r8",lines:1,children:i._("\u041e\u0442 Messenger")})]}),k.jsx("div",{className:"_9dxh"}),k.jsxs("div",{className:"_9dzn",children:[d&&k.jsx(b("BasePopoverTrigger.react"),{autoAlign:!0,popover:b("MessagingPluginDesktopThreadMenu.react"),popoverProps:{history:this.props.history,isMuted:this.state.isMuted,onClickMuteOrUnmute:this.$2,onUpgrade:this.$3},children:function(a,c){return k.jsx("div",{ref:a,children:k.jsx(b("MPNHeaderActionButton.react"),{label:i._("\u0415\u0449\u0451"),onPress:c,children:k.jsx(b("MPNMoreInfoButtonSVG.react"),{})})})}}),k.jsx(b("MPNHeaderActionButton.react"),{label:i._("\u0437\u0430\u043a\u0440\u044b\u0442\u044c"),onPress:function(){var b;return(b=a.props.ActionDelegate)==null?void 0:b.minimize()},children:k.jsx(b("Image.react"),{src:g("587992")})})]})]})};return c}(k.PureComponent);e.exports=a;a.contextType=b("MessagingPluginContext")}),null);
__d("MPNDesktopGuestAttachmentButton.react",["cx","MessagingPluginContext","MPNConstants","MPNPaperclipIconSVG.react","MPNStorage","React","ShimButton.react"],(function(a,b,c,d,e,f,g){"use strict";var h=b("React");a=function(a){babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.render=function(){var a=this.context.dispatchAction;return h.jsx(b("ShimButton.react"),{"data-testid":void 0,className:"_95jj",onClick:function(){b("MPNStorage").setShowUpgradePrompt(b("MPNConstants").MPNUpgradePrompt.ATTACHMENT_UPSELL),a({type:"UPDATE_UPGRADE_UPSELL_PROMPT",upgradeUpsellPrompt:b("MPNConstants").MPNUpgradePrompt.ATTACHMENT_UPSELL})},children:h.jsx(b("MPNPaperclipIconSVG.react"),{color:this.context.state.threadCSSColor})})};return c}(h.Component);e.exports=a;a.contextType=b("MessagingPluginContext")}),null);
__d("MPNDesktopGuestUpgradeUpsellPrompt.react",["ix","cx","fbt","Arbiter","CometPressable.react","Image.react","LiveChatPluginLoggerUtil","LiveChatPluginPromptButton.react","MessagingPluginContext","MessagingPluginThreadActions","MPNConstants","MPNGuestUpgradeFBTStrings","MPNStorage","React","asset"],(function(a,b,c,d,e,f,g,h,i){"use strict";var j=b("React");a=function(a){babelHelpers.inheritsLoose(c,a);function c(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.$1=null,b)||babelHelpers.assertThisInitialized(c)}var d=c.prototype;d.componentWillUnmount=function(){this.$1&&b("Arbiter").unsubscribe(this.$1)};d.componentDidMount=function(){var a=this.context.state,c=a.pageID;a=a.guestID;b("LiveChatPluginLoggerUtil").logImpressionFromNewUI("tab_impression",c,"upgrade_prompt",null,null,null,null,null,a,{prompt_type:this.props.prompt})};d.render=function(){var a=this,c=this.props.prompt,d=b("MPNGuestUpgradeFBTStrings").getPromptTitle(c,this.context),e=b("MPNGuestUpgradeFBTStrings").getPromptSubtitle(c,this.context),f=c===b("MPNConstants").MPNUpgradePrompt.DONT_WAIT_FOR_REPLY_UPSELL;return j.jsxs("div",{className:"_95to"+(f?"":" _9aqp"),children:[j.jsxs("div",{className:"promptHeaderContainer",children:[j.jsx("div",{className:"_95tx",children:j.jsx(b("Image.react"),{className:"messengerIcon",src:g("1273954")})}),j.jsxs("div",{className:"_95tr",children:[j.jsx("div",{className:"_95ty",children:d}),j.jsx("div",{className:"_95tz",children:e})]}),f&&j.jsx("div",{className:"_9aqq _95lg",children:j.jsx(b("CometPressable.react"),{"aria-label":i._("\u0417\u0430\u043a\u0440\u044b\u0442\u044c"),onPress:function(){b("MPNStorage").setShowUpgradePrompt(b("MPNConstants").MPNUpgradePrompt.NOT_SHOWN),a.$2()},overlayRadius:50,children:j.jsx(b("Image.react"),{src:g("478231")})})})]}),j.jsx("div",{className:"promptFooterContainer",children:f?j.jsx("div",{className:"continueButton",children:j.jsx(b("LiveChatPluginPromptButton.react"),{color:this.props.color,hasIcon:!1,onClick:function(){a.$1=b("MessagingPluginThreadActions").launchUpgradeFlowDesktop(a.context,a.props.history,c),a.$3()},text:i._("\u041f\u0435\u0440\u0435\u0439\u0442\u0438 \u0432 Messenger")})}):j.jsxs(j.Fragment,{children:[j.jsx("div",{className:"dismissButton footerButton",children:j.jsx(b("LiveChatPluginPromptButton.react"),{color:"rgba(0, 0, 0, .05)",hasIcon:!1,onClick:function(){b("MPNStorage").setShowUpgradePrompt(b("MPNConstants").MPNUpgradePrompt.NOT_SHOWN),a.$2()},text:i._("\u041d\u0435 \u0441\u0435\u0439\u0447\u0430\u0441")})}),j.jsx("div",{className:"continueButton footerButton",children:j.jsx(b("LiveChatPluginPromptButton.react"),{color:this.props.color,hasIcon:!0,onClick:function(){a.$1=b("MessagingPluginThreadActions").launchUpgradeFlowDesktop(a.context,a.props.history,c),a.$3()},text:i._("\u041f\u0440\u043e\u0434\u043e\u043b\u0436\u0438\u0442\u044c")})})]})})]})};d.$3=function(){var a=this.context.state,c=a.guestID;a=a.pageID;b("LiveChatPluginLoggerUtil").logActionFromNewUI("tab_click",c,a,"upgrade_prompt",{button_name:"upgrade_prompt_continue",prompt_type:this.props.prompt})};d.$2=function(){var a=this.context,c=a.dispatchAction;a=a.state;var d=a.guestID;a=a.pageID;c({type:"UPDATE_UPGRADE_UPSELL_PROMPT",upgradeUpsellPrompt:b("MPNConstants").MPNUpgradePrompt.NOT_SHOWN});b("LiveChatPluginLoggerUtil").logActionFromNewUI("tab_click",d,a,"upgrade_prompt",{button_name:"upgrade_prompt_not_now",prompt_type:this.props.prompt})};return c}(j.Component);e.exports=a;a.contextType=b("MessagingPluginContext")}),null);
__d("MPNDesktopSwitchAccountMenu.react",["cx","fbt","CometMenu.react","CometMenuItem.react","MessagingPluginContext","MessagingPluginThreadActions","React"],(function(a,b,c,d,e,f,g,h){"use strict";e.exports=a;var i=b("React");function a(a){var c=i.useContext(b("MessagingPluginContext"));return i.jsx("div",{"data-testid":void 0,className:"_968x",children:i.jsx(b("CometMenu.react"),{size:"normal",withArrow:!0,children:i.jsx(b("CometMenuItem.react"),{onClick:function(){b("MessagingPluginThreadActions").switchAccount(c)},primaryText:h._("\u041f\u0435\u0440\u0435\u043a\u043b\u044e\u0447\u0438\u0442\u044c\u0441\u044f \u043d\u0430 \u0434\u0440\u0443\u0433\u043e\u0439 \u0430\u043a\u043a\u0430\u0443\u043d\u0442")})})})}}),null);
__d("MessagingPluginDesktopInformationMenu.react",["cx","fbt","CometMenu.react","CometMenuItem.react","MessagingPluginContext","React","URI"],(function(a,b,c,d,e,f,g,h){"use strict";e.exports=a;var i,j=b("React");function a(a){a=j.useContext(b("MessagingPluginContext"));var c=a.state.pageID;return j.jsx("div",{"data-testid":void 0,className:"_968x",children:j.jsxs(b("CometMenu.react"),{size:"full",withArrow:!0,children:[j.jsx(b("CometMenuItem.react"),{onClick:function(){(i||(i=b("URI"))).goURIOnNewWindow("https://www.facebook.com/"+c)},primaryText:h._("\u041f\u043e\u0441\u0435\u0442\u0438\u0442\u044c \u0421\u0442\u0440\u0430\u043d\u0438\u0446\u0443 Facebook")}),j.jsx(b("CometMenuItem.react"),{onClick:function(){(i||(i=b("URI"))).goURIOnNewWindow("https://www.facebook.com/business/m/add-messenger-to-your-website")},primaryText:h._("\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c Messenger \u043d\u0430 \u0441\u0432\u043e\u0439 \u0441\u0430\u0439\u0442")})]})})}}),null);
__d("XChatPluginDesktopIncognitoLoginPopupController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/plugins/chat/incognito_login/",{})}),null);
__d("MPNDesktopWelcomePageModal.react",["ix","cx","fbt","BasePopoverTrigger.react","CometLink.react","CometPressable.react","EllipsisText.react","Image.react","LineClamp.react","LiveChatPluginConstants","LiveChatPluginLoggerUtil","MessagingPluginContext","MessagingPluginDesktopInformationMenu.react","MessagingPluginDesktopProfilePicture.react","MPNConstants","MPNDesktopSwitchAccountMenu.react","MPNHeaderActionButton.react","MPNIdentity","MPNLocalState","MPNMessengerIconSVG.react","MPNMoreInfoButtonSVG.react","MPNNavigation","MPNStorage","MPNXDMessageManager","PluginOptin","PopupWindow","React","ReactDOM","ShimButton.react","XChatPluginDesktopIncognitoLoginPopupController","XCookiesPolicyController","XDataPolicyController","XTermsController","asset","gkx","performanceAbsoluteNow"],(function(a,b,c,d,e,f,g,h,i){"use strict";var j,k=b("React"),l=250;a=function(a){babelHelpers.inheritsLoose(c,a);function c(){var c,d;for(var e=arguments.length,f=new Array(e),g=0;g<e;g++)f[g]=arguments[g];return(c=d=a.call.apply(a,[this].concat(f))||this,d.modalSheetRef=k.createRef(),d.$7=function(){var a=d.context,c=a.state;a=a.dispatchAction;c=c.pageID;a({type:"UPDATE_CONTINUE_CLICK_TIME",continueClickTime:(j||(j=b("performanceAbsoluteNow")))()});b("MPNIdentity").MPNIdentity.performUIAction(d.$10,function(){var a=b("MPNStorage").getFBStorageState();a==null?a={requestID:b("MPNStorage").requestID,currentPath:b("MPNLocalState").MPNLocalStatePath.THREAD_VIEW,userID:"0",chatState:b("MPNLocalState").MPNChatState.CHAT_NOT_STARTED,visibility:"not-hidden",showUpgradePrompt:b("MPNConstants").MPNUpgradePrompt.NOT_SHOWN,accessToken:null,expirationTimestamp:null,rdr:b("MPNConstants").MPNRedirect.NEW_GUEST_SESSION}:a=babelHelpers["extends"]({},a,{chatState:b("MPNLocalState").MPNChatState.CHAT_NOT_STARTED,rdr:"new_guest_sess"});b("MPNStorage").setFBStorageState(a);b("MPNXDMessageManager").reloadPlugin()},function(){var a=d.context.dispatchAction;a({type:"UPDATE_COOKIE_ACCESS_DENIED",cookieAccessDenied:!0});d.$10()});b("LiveChatPluginLoggerUtil").logActionFromNewUI("tab_click",null,c,"welcome_page_with_guest_option",{button_name:"continue_as_guest"})},d.$10=function(){b("MPNNavigation").navigateToRoute(d.props.history,b("MPNLocalState").MPNLocalStatePath.THREAD_VIEW),d.props.ActionDelegate&&d.props.ActionDelegate.onContinueAsGuest(function(){})},d.$11=function(){var a=d.context,c=a.state;a=a.dispatchAction;c=c.pageID;a({type:"UPDATE_CONTINUE_CLICK_TIME",continueClickTime:(j||(j=b("performanceAbsoluteNow")))()});b("MPNIdentity").MPNIdentity.performUIAction(function(){b("MPNNavigation").navigateToRoute(d.props.history,b("MPNLocalState").MPNLocalStatePath.THREAD_VIEW)},function(){b("MPNIdentity").MPNIdentity.clearUserChangesSubscription(),b("MPNStorage").setPath(b("MPNLocalState").MPNLocalStatePath.THREAD_VIEW),b("MPNXDMessageManager").reloadPlugin()},function(){b("MPNStorage").clearThirdPartyStorageState(),b("MPNXDMessageManager").reloadPlugin()});b("LiveChatPluginLoggerUtil").logActionFromNewUI("tab_click",null,c,"itp_page",{button_name:"continue"})},c)||babelHelpers.assertThisInitialized(d)}var d=c.prototype;d.componentDidMount=function(){var a=this.context.state.hasGuestMode;this.$1(a)};d.render=function(){return k.jsx("div",{children:this.$2()})};d.$2=function(){var a=this,c=this.context.state,d=c.hasGuestMode;c=c.pageName;var e=this.context.state,f=b("MPNIdentity").MPNIdentity.currentUserState()==b("MPNIdentity").MPNIdentityState.FB,h=b("gkx")("1189683"),j=b("XTermsController").getURIBuilder().getURI().toString(),l=b("XDataPolicyController").getURIBuilder().getURI().toString(),m=b("XCookiesPolicyController").getURIBuilder().getURI().toString(),n=i._("\u041e\u0431\u0449\u0430\u0439\u0442\u0435\u0441\u044c \u0432 \u0447\u0430\u0442\u0435 \u0441\u043e \u0421\u0442\u0440\u0430\u043d\u0438\u0446\u0435\u0439 {pageName}",[i._param("pageName",e.pageName)]);return k.jsx("div",{role:"none",className:"_94ve",children:k.jsx("div",{ref:this.modalSheetRef,className:"_94vf",onClick:this.$3,role:"none",children:k.jsxs("div",{className:"welcomePageModalSheetContent",children:[k.jsxs("div",{className:"_9095",children:[k.jsx(b("MessagingPluginDesktopProfilePicture.react"),{className:"_9096",greenDotSize:"large"}),k.jsx("div",{className:"_9dxh"}),k.jsxs("div",{className:"_9dzn",children:[f?k.jsx(b("BasePopoverTrigger.react"),{align:"middle",autoAlign:!0,popover:b("MPNDesktopSwitchAccountMenu.react"),popoverProps:{},children:function(a,c){return k.jsx("div",{ref:a,className:"_97lh",children:k.jsxs(b("CometPressable.react"),{testid:void 0,onPress:c,overlayRadius:6,children:[k.jsx(b("Image.react"),{className:"_95lg _97lg",src:e.viewerProfilePicureUri}),k.jsx(b("Image.react"),{className:"_97lc",src:g("481882")})]})})}}):null,k.jsx(b("BasePopoverTrigger.react"),{autoAlign:!0,popover:b("MessagingPluginDesktopInformationMenu.react"),popoverProps:{},children:function(a,c){return k.jsx("div",{ref:a,children:k.jsx(b("MPNHeaderActionButton.react"),{label:i._("\u0415\u0449\u0451"),onPress:c,children:k.jsx(b("MPNMoreInfoButtonSVG.react"),{})})})}}),k.jsx(b("MPNHeaderActionButton.react"),{label:i._("\u0437\u0430\u043a\u0440\u044b\u0442\u044c"),onPress:function(){var b;return(b=a.props.ActionDelegate)==null?void 0:b.minimize()},children:k.jsx(b("Image.react"),{src:g("587992")})})]})]}),k.jsx(b("LineClamp.react"),{className:"_9099",lines:1,children:k.jsx("strong",{children:n})}),k.jsx(b("LineClamp.react"),{className:"_909a",lines:1,children:e.pageResponsiveness}),k.jsx(b("LineClamp.react"),{className:"_909b",lines:3,children:f?e.loggedInGreeting:e.loggedOutGreeting}),this.props.useITPContinueButton?this.$4():this.$5(d),k.jsx("div",{className:"_924l",children:this.props.useITPContinueButton?null:d?h?i._("\u041f\u0440\u043e\u0434\u043e\u043b\u0436\u0430\u044f \u0434\u0435\u0439\u0441\u0442\u0432\u043e\u0432\u0430\u0442\u044c \u0432 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0435 \u0433\u043e\u0441\u0442\u044f, \u0432\u044b \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0435\u0442\u0435 {=Terms} Facebook. \u0423\u0437\u043d\u0430\u0442\u044c \u043e \u0442\u043e\u043c, \u043a\u0430\u043a \u043c\u044b \u0441\u043e\u0431\u0438\u0440\u0430\u0435\u043c, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c \u0438 \u043f\u0435\u0440\u0435\u0434\u0430\u0435\u043c \u0432\u0430\u0448\u0438 \u0434\u0430\u043d\u043d\u044b\u0435, \u0432\u044b \u043c\u043e\u0436\u0435\u0442\u0435 \u0432 \u043d\u0430\u0448\u0435\u0439 {=Data Policy}, \u0430 \u043e\u0431 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0438 \u0444\u0430\u0439\u043b\u043e\u0432 cookie \u0438 \u0430\u043d\u0430\u043b\u043e\u0433\u0438\u0447\u043d\u044b\u0445 \u0442\u0435\u0445\u043d\u043e\u043b\u043e\u0433\u0438\u0439\u00a0\u2014 \u0432 {=Cookies Policy}. \u0415\u0441\u043b\u0438 \u0432\u044b \u0432\u043e\u0439\u0434\u0435\u0442\u0435 \u0432 \u0430\u043a\u043a\u0430\u0443\u043d\u0442, \u0421\u0442\u0440\u0430\u043d\u0438\u0446\u0435 {pageName} \u0441\u0442\u0430\u043d\u0443\u0442 \u0438\u0437\u0432\u0435\u0441\u0442\u043d\u044b \u0441\u0430\u0439\u0442, \u0441 \u043a\u043e\u0442\u043e\u0440\u043e\u0433\u043e \u0432\u044b \u043f\u0440\u0438\u0448\u043b\u0438, \u0438 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f, \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u0430\u044f \u0434\u043b\u044f \u0432\u0441\u0435\u0445 \u0432 \u0432\u0430\u0448\u0435\u043c \u043f\u0440\u043e\u0444\u0438\u043b\u0435 Facebook.",[i._param("=Terms",k.jsx(b("CometLink.react"),{href:j,target:"_blank",children:i._("\u0423\u0441\u043b\u043e\u0432\u0438\u044f")})),i._param("=Data Policy",k.jsx(b("CometLink.react"),{href:l,target:"_blank",children:i._("\u041f\u043e\u043b\u0438\u0442\u0438\u043a\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f \u0434\u0430\u043d\u043d\u044b\u0445")})),i._param("=Cookies Policy",k.jsx(b("CometLink.react"),{href:m,target:"_blank",children:i._("\u041f\u043e\u043b\u0438\u0442\u0438\u043a\u0435 \u0432 \u043e\u0442\u043d\u043e\u0448\u0435\u043d\u0438\u0438 \u0444\u0430\u0439\u043b\u043e\u0432 cookie")})),i._param("pageName",c)]):i._("\u041f\u0440\u043e\u0434\u043e\u043b\u0436\u0430\u044f \u0434\u0435\u0439\u0441\u0442\u0432\u043e\u0432\u0430\u0442\u044c \u0432 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0435 \u0433\u043e\u0441\u0442\u044f, \u0432\u044b \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0435\u0442\u0435 {=Terms}, {=Data Policy} \u0438 {=Cookies Policy} Facebook. \u0415\u0441\u043b\u0438 \u0432\u044b \u0432\u043e\u0439\u0434\u0435\u0442\u0435 \u0432 \u0430\u043a\u043a\u0430\u0443\u043d\u0442, \u0421\u0442\u0440\u0430\u043d\u0438\u0446\u0435 {pageName} \u0441\u0442\u0430\u043d\u0443\u0442 \u0438\u0437\u0432\u0435\u0441\u0442\u043d\u044b \u0441\u0430\u0439\u0442, \u0441 \u043a\u043e\u0442\u043e\u0440\u043e\u0433\u043e \u0432\u044b \u043f\u0440\u0438\u0448\u043b\u0438, \u0438 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f, \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u0430\u044f \u0434\u043b\u044f \u0432\u0441\u0435\u0445 \u0432 \u0432\u0430\u0448\u0435\u043c \u043f\u0440\u043e\u0444\u0438\u043b\u0435 Facebook.",[i._param("=Terms",k.jsx(b("CometLink.react"),{href:j,target:"_blank",children:i._("\u0423\u0441\u043b\u043e\u0432\u0438\u044f")})),i._param("=Data Policy",k.jsx(b("CometLink.react"),{href:l,target:"_blank",children:i._("\u041f\u043e\u043b\u0438\u0442\u0438\u043a\u0443 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f \u0434\u0430\u043d\u043d\u044b\u0445")})),i._param("=Cookies Policy",k.jsx(b("CometLink.react"),{href:m,target:"_blank",children:i._("\u041f\u043e\u043b\u0438\u0442\u0438\u043a\u0443 \u0432 \u043e\u0442\u043d\u043e\u0448\u0435\u043d\u0438\u0438 \u0444\u0430\u0439\u043b\u043e\u0432 cookie")})),i._param("pageName",c)]):i._("\u0415\u0441\u043b\u0438 \u0432\u044b \u0432\u043e\u0439\u0434\u0435\u0442\u0435 \u0432 \u0430\u043a\u043a\u0430\u0443\u043d\u0442, \u0421\u0442\u0440\u0430\u043d\u0438\u0446\u0430 {pageName} \u0443\u0432\u0438\u0434\u0438\u0442 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u0441\u0430\u0439\u0442\u0435, \u0441 \u043a\u043e\u0442\u043e\u0440\u043e\u0433\u043e \u0432\u044b \u043f\u0435\u0440\u0435\u0448\u043b\u0438, \u0438 \u0432\u0430\u0448\u0438 \u043e\u0431\u0449\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435 \u0432 \u043f\u0440\u043e\u0444\u0438\u043b\u0435 Facebook.",[i._param("pageName",c)])})]})})})};d.$6=function(){var a,c=b("MPNIdentity").MPNIdentity.currentUserState()==b("MPNIdentity").MPNIdentityState.FB;a=(a=b("MPNIdentity").MPNIdentity.currentUser())==null?void 0:a.shortName;if(!c)return i._("\u0412\u043e\u0439\u0434\u0438\u0442\u0435 \u0432 Messenger");return a!==null?i._("\u041f\u0440\u043e\u0434\u043e\u043b\u0436\u0438\u0442\u044c \u043a\u0430\u043a {first name}",[i._param("first name",a)]):i._("\u041f\u0440\u043e\u0434\u043e\u043b\u0436\u0438\u0442\u044c")};d.$5=function(a){var c=this.context.state.threadCSSColor,d=b("MPNIdentity").MPNIdentity.currentUserState()==b("MPNIdentity").MPNIdentityState.FB;d=a?k.jsx(b("ShimButton.react"),{"data-testid":void 0,onClick:this.$7,className:"_909e",children:k.jsx(b("LineClamp.react"),{lines:1,children:i._("\u041f\u0440\u043e\u0434\u043e\u043b\u0436\u0438\u0442\u044c \u043a\u0430\u043a \u0433\u043e\u0441\u0442\u044c")})}):null;return k.jsxs("div",{className:"_909c",children:[k.jsxs(b("ShimButton.react"),{"data-testid":void 0,onClick:this.$8.bind(this),className:"_909d",style:{backgroundColor:c},children:[k.jsx(b("MPNMessengerIconSVG.react"),{}),k.jsx(b("EllipsisText.react"),{className:"continueText",children:this.$6()})]}),d]})};d.$8=function(){var a=this,c=this.context,d=c.state,e=c.dispatchAction;c=d.pageID;var f=d.hasGuestMode,g=d.pagePassesSentryTest;d=d.hasMessagingPermission;var h=b("MPNIdentity").MPNIdentity.currentUserState(),i=b("MPNIdentity").MPNIdentity.currentUserID();e({type:"UPDATE_CONTINUE_CLICK_TIME",continueClickTime:(j||(j=b("performanceAbsoluteNow")))()});if(h==b("MPNIdentity").MPNIdentityState.FB&&i!=null){if(!g&&!d){(h=this.props.ActionDelegate)==null?void 0:h.openThreadWithInterstitial(function(){var c;(c=a.props.ActionDelegate)==null?void 0:c.openThreadWithCurrentFBUser();b("MPNNavigation").navigateToRoute(a.props.history,b("MPNLocalState").MPNLocalStatePath.THREAD_VIEW);e({type:"UPDATE_BLOCK_STATUS",isPageBlocked:!1})});return}b("MPNNavigation").navigateToRoute(this.props.history,b("MPNLocalState").MPNLocalStatePath.THREAD_VIEW);(i=this.props.ActionDelegate)==null?void 0:i.openThreadWithCurrentFBUser();b("LiveChatPluginLoggerUtil").logActionFromNewUI("tab_click",null,c,f?"welcome_page_with_guest_option":"welcome_page",{button_name:"continue_as"});return}b("MPNIdentity").MPNIdentity.performUIAction(function(){if(b("MPNIdentity").MPNIdentity.cookieUserUncached()!="0")return;b("MPNIdentity").MPNIdentity.subscribeLoggedInUserChanges(function(a,c){a=b("MPNStorage").getFBStorageState();if(a!=null){b("MPNStorage").setFBStorageState(babelHelpers["extends"]({},a,{chatState:b("MPNLocalState").MPNChatState.LOGGED_IN_CHAT_STARTED,rdr:b("MPNConstants").MPNRedirect.FB_LOG_IN}));c={path:b("MPNLocalState").MPNLocalStatePath.THREAD_VIEW,chatState:b("MPNLocalState").MPNChatState.LOGGED_IN_CHAT_STARTED,visibility:"not-hidden"};b("MPNStorage").setThirdPartyStorageState(c)}},l);a.$9(!1,!1)},function(){if(b("MPNIdentity").MPNIdentity.cookieUserUncached()!="0"){b("MPNXDMessageManager").reloadPlugin();return}b("MPNIdentity").MPNIdentity.subscribeLoggedInUserChanges(function(a,c){a=b("MPNStorage").getFBStorageState();a!=null&&b("MPNStorage").setFBStorageState(babelHelpers["extends"]({},a,{chatState:b("MPNLocalState").MPNChatState.LOGGED_IN_CHAT_STARTED,rdr:b("MPNConstants").MPNRedirect.FB_LOG_IN}))},l);a.$9(!1,!1)},function(){var a=b("XChatPluginDesktopIncognitoLoginPopupController").getURIBuilder().getURI();b("PopupWindow").open(a.toString(),420,450)});b("LiveChatPluginLoggerUtil").logActionFromNewUI("tab_click",null,c,f?"welcome_page_with_guest_option":"welcome_page",{button_name:"log_in_messenger"})};d.$9=function(a,c){var d=this.context.state,e=d.refererUri,f=d.pageID,g=d.initialRequestUri;d=d.requestID;new(b("PluginOptin"))("customer_chat").addLoginParams({logged_in:a,page_id:f,switch_user:c,request_id:d}).addReturnParams((a=g==null?void 0:g.getQueryData())!=null?a:{}).addReturnParams({customer_chat_origin_uri:e,referer_uri:e}).start()};d.$4=function(){var a=this.context.state.threadCSSColor;return k.jsx("div",{className:"_909c",children:k.jsx(b("ShimButton.react"),{onClick:this.$11,className:"_909d",style:{backgroundColor:a},children:k.jsx(b("LineClamp.react"),{className:"continueText",lines:1,children:i._("\u041f\u0440\u043e\u0434\u043e\u043b\u0436\u0438\u0442\u044c")})})})};d.$1=function(a){var c=b("ReactDOM").findDOMNode(this.modalSheetRef.current);if(c instanceof HTMLElement){a=a?b("LiveChatPluginConstants").WELCOME_PAGE_GUEST_FALLBACK_HEIGHT:b("LiveChatPluginConstants").WELCOME_PAGE_NO_GUEST_FALLBACK_HEIGHT;c=Math.max(c.offsetHeight,a);a=c+b("LiveChatPluginConstants").WELCOME_PAGE_PADDING_HEIGHT;b("MPNXDMessageManager").resizeIframe(a.toString())}};d.$3=function(a){a.stopPropagation()};return c}(k.Component);e.exports=a;a.contextType=b("MessagingPluginContext")}),null);
__d("MPNDesktopITPContinuePage.react",["LiveChatPluginLoggerUtil","MessagingPluginContext","MPNDesktopWelcomePageModal.react","MPNXDMessageManager","React"],(function(a,b,c,d,e,f){"use strict";var g=b("React");a=function(a){babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.componentDidMount=function(){var a=this.context.state,c=a.alignment,d=a.pageID;a=a.pluginMountTime;b("MPNXDMessageManager").setupDesktopIframe(c);b("LiveChatPluginLoggerUtil").logImpressionFromNewUI("tab_impression",d,"itp_page",a,["continue"])};d.render=function(){try{return g.jsx(b("MPNDesktopWelcomePageModal.react"),{ActionDelegate:this.props.ActionDelegate,history:this.props.history,useITPContinueButton:!0})}catch(a){b("LiveChatPluginLoggerUtil").logImpressionExceptionsFromNewUI("tab_load_failure",this.context.state.pageID,"itp_page",a.name,a.message,a.stack)}};return c}(g.Component);e.exports=a;a.contextType=b("MessagingPluginContext")}),null);
__d("MPNDesktopIcon.react",["ClickableArea.react","LiveChatPluginDefaultMessengerIconSVG.react","LiveChatPluginLoggerUtil","LiveChatPluginMessengerIconSVGWithColor.react","MPNXDMessageManager","React"],(function(a,b,c,d,e,f){"use strict";var g=b("React");a=function(a){babelHelpers.inheritsLoose(c,a);function c(){var c,d;for(var e=arguments.length,f=new Array(e),g=0;g<e;g++)f[g]=arguments[g];return(c=d=a.call.apply(a,[this].concat(f))||this,d.state={visibility:d.props.initialVisibility,disabled:!1},d.$1=function(a){a=((a=a.data.params)==null?void 0:a.is_dialog_hidden)==!0?"hidden":"not-hidden";d.setState({visibility:a})},d.$2=function(){if(d.state.disabled==!0)return;else b("MPNXDMessageManager").fetchThirdPartyState(function(a){a=(a=a==null?void 0:(a=a.params)==null?void 0:a.visibility)!=null?a:d.state.visibility;var b=a=="hidden"?"not-hidden":"hidden";a=="not-hidden"?d.props.actionDelegate.minimize():d.props.actionDelegate.maximize();d.setState({visibility:b})}),d.setState({disabled:!0}),window.setTimeout(function(){d.setState({disabled:!1})},350)},c)||babelHelpers.assertThisInitialized(d)}var d=c.prototype;d.componentDidMount=function(){b("LiveChatPluginLoggerUtil").logImpressionFromNewUI("tab_impression",this.props.pageID,"plugin_icon",this.props.pluginRequestTime),b("MPNXDMessageManager").subscribeEvent("desktop-icon","message","CustomerChat.isDialogHidden",this.$1)};d.render=function(){return g.jsx(b("ClickableArea.react"),{onClick:this.$2,children:g.jsx("svg",{width:"60px",height:"60px",viewBox:"0 0 60 60",cursor:"pointer",children:this.props.threadColor!=null?g.jsx(b("LiveChatPluginMessengerIconSVGWithColor.react"),{threadColor:this.props.threadColor}):g.jsx(b("LiveChatPluginDefaultMessengerIconSVG.react"),{})})})};return c}(g.Component);e.exports=a}),null);
__d("MPNDesktopMessageComposer.react",["cx","fbt","AbstractTextInput.react","Keys","LiveChatPluginAttachmentUploadError","LiveChatPluginLoggerUtil","LiveChatPluginMessageComposerAttachmentShelf.react","LiveChatPluginSendButtonSVG.react","MercuryIDs","MercuryMessageActions","MercuryMessageObject","MessagingPluginContext","MPNDesktopAttachmentInput.react","MPNDesktopBotMenuButton.react","MPNDesktopGuestAttachmentButton.react","MPNIdentity","MPNLocalState","React","ShimButton.react"],(function(a,b,c,d,e,f,g,h){"use strict";var i=b("React");a=function(a){babelHelpers.inheritsLoose(c,a);function c(c,d){var e;e=a.call(this,c,d)||this;e.state={attachmentsDataMap:new Map(),error:b("LiveChatPluginAttachmentUploadError").NO_ERROR,inputValue:"",uploadingAttachments:new Set()};e.$19=function(a){e.props.onChange(),e.setState({error:b("LiveChatPluginAttachmentUploadError").NO_ERROR,inputValue:a.target.value})};e.$20=function(a){a.keyCode===b("Keys").RETURN&&(a.preventDefault(),e.$18())};e.$18=function(){var a=b("MPNIdentity").MPNIdentity.currentUserState();a===b("MPNIdentity").MPNIdentityState.FB?e.$21():a===b("MPNIdentity").MPNIdentityState.GUEST&&e.$22()};e.$11=function(a){e.$2&&e.$2.removeAttachment(a)};e.$15=function(a){e.setState({error:a})};e.$16=function(a,c,d,f,g,h){d&&(e.$1=d),f&&(e.$3=f),g&&(e.$4=g),h&&(e.$10=h),e.setState({attachmentsDataMap:new Map(a),error:b("LiveChatPluginAttachmentUploadError").NO_ERROR,uploadingAttachments:new Set(c)}),e.focus()};c=e.context.state.pageID;d=b("MPNIdentity").MPNIdentity.currentUserID();if(d==null)return babelHelpers.assertThisInitialized(e);e.$6=b("MercuryMessageActions").getForFBID(d);e.$7=b("MercuryMessageObject").getForFBID(d);e.$8=b("MercuryIDs").getThreadIDFromUserID(c);e.$9=b("LiveChatPluginLoggerUtil").getAttributionTags();e.$1=[];e.$3=[];e.$4=[];e.$10=[];return e}var d=c.prototype;d.render=function(){return i.jsxs("div",{className:(this.context.state.isComposerDisabled?"_664i":"")+" _94vs",children:[i.jsx(b("LiveChatPluginMessageComposerAttachmentShelf.react"),{attachments:this.state.attachmentsDataMap,error:this.state.error,removeAttachment:this.$11,threadColor:this.context.state.threadColor,uploadingAttachments:this.state.uploadingAttachments}),i.jsxs("div",{className:"_94vt",children:[this.$12(),this.$13(),this.$14()]})]})};d.$12=function(){var a=this,c=this.context.state,d=c.isComposerDisabled,e=c.optimisticStorageState;c=c.showUpgradeUpsellPrompt;if(d||e.chatState===b("MPNLocalState").MPNChatState.CHAT_NOT_STARTED)return null;if(b("MPNIdentity").MPNIdentity.currentUserState()===b("MPNIdentity").MPNIdentityState.GUEST)if(c===!0)return i.jsx(b("MPNDesktopGuestAttachmentButton.react"),{threadColor:this.context.state.threadCSSColor});else return null;d=b("MPNIdentity").MPNIdentity.currentUserID();return d==null?null:i.jsx(b("MPNDesktopAttachmentInput.react"),{pageID:this.context.state.pageID,ref:function(b){a.$2=b},setComposerAttachmentError:this.$15,updateComposerAttachmentsAndIDs:this.$16,viewerID:d})};d.$14=function(){var a=this.context.state,c=a.isComposerDisabled;a=a.threadCSSColor;var d=this.state.inputValue.length===0&&this.state.attachmentsDataMap.size===0;return d||c?this.$17():i.jsx(b("ShimButton.react"),{"aria-label":h._("\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c"),className:"_4bqf _95jk","data-testid":void 0,onClick:this.$18,children:i.jsx(b("LiveChatPluginSendButtonSVG.react"),{threadColor:a})})};d.$13=function(){var a=this,c=this.context.state,d=c.pageName;c=c.isComposerDisabled;return c?i.jsx("div",{className:"_664k",children:h._("\u0421\u0442\u0440\u0430\u043d\u0438\u0446\u0430 {page name} \u043e\u0442\u043a\u043b\u044e\u0447\u0438\u043b\u0430 \u0432\u0432\u043e\u0434 \u0442\u0435\u043a\u0441\u0442\u0430.",[h._param("page name",d)])}):i.jsx("div",{className:"_94vv",children:i.jsx(b("AbstractTextInput.react"),{"data-testid":void 0,onBlur:this.props.onBlur,onChange:this.$19,onClick:this.props.onClick,onFocus:this.props.onFocus,onKeyDown:this.$20,ref:function(b){a.$5=b},placeholder:h._("\u0417\u0430\u0434\u0430\u0439\u0442\u0435 \u0432\u043e\u043f\u0440\u043e\u0441 ...").toString(),value:this.state.inputValue})})};d.$17=function(){return i.jsx(b("MPNDesktopBotMenuButton.react"),{onClick:this.props.onClick})};d.$22=function(){var a=this.context.state;if(!a.messageStore||!a.messageStore.sendQueue)return;var c=a.messageStore.sendQueue,d=this.state.inputValue.trim();d&&d.length>0&&c.enqueueAndSend(d,null);this.setState({inputValue:""});b("LiveChatPluginLoggerUtil").logActionFromNewUI("message_send",a.guestID,a.pageID,"guest_chat_tab")};d.$21=function(){var a=this.context.state.pageID,c=b("MPNIdentity").MPNIdentity.currentUserID();if(this.state.uploadingAttachments.size!==0)return;var d=this.state.inputValue.trim();if(d&&d.length>0||this.state.attachmentsDataMap.size>0){d=this.$7.constructUserGeneratedMessageObject(d,"source:discovery:customer_chat_plugin",this.$8,null,null,this.$9);this.$4.length>0&&(d.has_attachment=!0,d.image_ids=this.$4);this.$1.length>0&&(d.has_attachment=!0,d.gif_ids=this.$1);this.$10.length>0&&(d.has_attachment=!0,d.video_ids=this.$10);this.$3.length>0&&(d.has_attachment=!0,d.file_ids=this.$3);this.$6.send(d);this.setState({inputValue:""});this.$23();b("LiveChatPluginLoggerUtil").logActionDEPRECATED("message_sent",c,a,this.state.attachmentsDataMap.size>0?JSON.stringify({attachments:Array.from(this.state.attachmentsDataMap.keys())}):null);b("LiveChatPluginLoggerUtil").logAction("customer_chat_message_sent",c,a,this.state.attachmentsDataMap.size>0?JSON.stringify({attachments:Array.from(this.state.attachmentsDataMap.keys())}):null);b("LiveChatPluginLoggerUtil").logActionFromNewUI("message_send",c,a,"logged_in_chat_tab")}};d.$23=function(){this.$2&&this.$2.removeAllAttachments()};d.focus=function(){this.$5&&this.$5.focusInput()};return c}(i.PureComponent);e.exports=a;a.contextType=b("MessagingPluginContext")}),null);
__d("MPNDesktopWelcomePage.react",["LiveChatPluginLoggerUtil","MessagingPluginContext","MPNDesktopWelcomePageModal.react","MPNIdentity","React"],(function(a,b,c,d,e,f){"use strict";var g=b("React");a=function(a){babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.componentDidMount=function(){var a=this.context.state,c=a.pageID,d=a.pluginMountTime;a=a.hasGuestMode;var e=b("MPNIdentity").MPNIdentity.currentUserState()==b("MPNIdentity").MPNIdentityState.FB;b("LiveChatPluginLoggerUtil").logImpressionFromNewUI("tab_impression",c,a?"welcome_page_with_guest_option":"welcome_page",d,a?[e?"continue_as":"chat_in_messenger","continue_as_guest"]:["chat_in_messenger"])};d.render=function(){try{return g.jsx(b("MPNDesktopWelcomePageModal.react"),{ActionDelegate:this.props.ActionDelegate,history:this.props.history,useITPContinueButton:!1})}catch(d){var a=this.context.state,c=a.pageID;a=a.hasGuestMode;b("LiveChatPluginLoggerUtil").logImpressionExceptionsFromNewUI("tab_load_failure",c,a?"welcome_page_with_guest_option":"welcome_page",d.name,d.message,d.stack)}};return c}(g.Component);e.exports=a;a.contextType=b("MessagingPluginContext")}),null);
__d("PRETestMPNDesktopThreadPage.react",["cx","JSResource","LiveChatPluginConstants","LiveChatPluginLoggerUtil","MessagingPluginContext","MPNDesktopDialogHeader.react","MPNEndChatPrompt.react","lazyLoadComponent","MessengerSpinner.react","MPNDesktopGuestUpgradeUpsellPrompt.react","MessengerState.bs","MPNBlockedPageComposer.react","MPNLocalState","MPNDesktopMessageComposer.react","MPNXDMessageManager","MPNConstants","React","UnverifiedXD","MPNIdentity","emptyFunction"],(function(a,b,c,d,e,f,g){"use strict";var h=b("lazyLoadComponent")(b("JSResource")("MessagingPluginDialogBody.react").__setRef("PRETestMPNDesktopThreadPage.react")),i=b("MessengerState.bs").jsComponent,j=b("MPNLocalState").MPNChatState,k=b("MPNConstants").MPNUpgradePrompt,l=b("React"),m=b("MPNIdentity").MPNIdentity,n=b("MPNIdentity").MPNIdentityState;a=function(a){babelHelpers.inheritsLoose(c,a);function c(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.state={dialogBodyHeight:-1},b)||babelHelpers.assertThisInitialized(c)}var d=c.prototype;d.componentDidMount=function(){var a=b("LiveChatPluginConstants").THREAD_PAGE_HEIGHT+b("LiveChatPluginConstants").THREAD_PAGE_PADDING_HEIGHT;b("MPNXDMessageManager").resizeIframe(a.toString())};d.render=function(){var a=this,c=this.context.state,d=c.optimisticStorageState,e=c.pageID,f=c.isPageBlocked;c=c.showUpgradeUpsellPrompt;var g=m.currentUserID(),o=m.currentUserState()===n.GUEST;try{return l.jsx("div",{role:"none",className:"_94vg",children:l.jsx("div",{className:d.chatState===j.CHAT_NOT_STARTED?"_91hz":"",children:l.jsxs("div",{className:"_94vh",children:[l.jsx(b("MPNDesktopDialogHeader.react"),{ActionDelegate:this.props.ActionDelegate,history:this.props.history}),l.jsx("div",{className:"_424s",children:l.jsx(l.Suspense,{fallback:l.jsx("div",{className:"spinner",children:l.jsx(b("MessengerSpinner.react"),{color:"blue",size:b("MessengerSpinner.react").large_size})}),children:d.chatState!==j.CHAT_NOT_STARTED&&l.jsx(i,{fbid:g,children:function(c){return l.jsx(h,{deliveryReceipt:b("MessengerState.bs").deliveryReceipts(c),dialogBodyHeight:a.state.dialogBodyHeight,messengerState:c,readReceipt:null,sendRef:function(){}})}})})}),d.showUpgradePrompt==null||d.showUpgradePrompt===k.NOT_SHOWN||d.showUpgradePrompt===k.UNSAVED_MSG_UPSELL&&this.context.state.messageCount==null||!c?null:l.jsx(b("MPNDesktopGuestUpgradeUpsellPrompt.react"),{color:this.context.state.threadCSSColor,prompt:this.context.state.optimisticStorageState.showUpgradePrompt,history:this.props.history}),l.jsx(b("MPNEndChatPrompt.react"),{isGuest:o,history:this.props.history,shouldMinimize:!1}),f&&d.chatState===j.LOGGED_IN_CHAT_STARTED?l.jsx(b("MPNBlockedPageComposer.react"),{}):l.jsx(b("MPNDesktopMessageComposer.react"),{onBlur:this.$2()?this.$3:b("emptyFunction"),onChange:function(){},onClick:function(){},onFocus:this.$2()?this.$4:b("emptyFunction"),ref:function(b){return a.$1=b}})]},"dialog_container")})})}catch(a){b("LiveChatPluginLoggerUtil").logImpressionExceptionsFromNewUI("tab_load_failure",e,m.currentUserState()===n.FB?"logged_in_chat_tab":"guest_chat_tab",a.name,a.message,a.stack)}};d.$2=function(){return/iPhone|iPad|iPod/.test(navigator.userAgent)};d.$4=function(){b("UnverifiedXD").send({type:"liveChatPluginFocusComposer"})};d.$3=function(){b("UnverifiedXD").send({type:"liveChatPluginBlurComposer"})};return c}(l.Component);a.contextType=b("MessagingPluginContext");e.exports=a}),null);
__d("PRETestMPNDesktopRoute.react",["MessagingPluginPathUtils","MPNDesktopITPContinuePage.react","MPNDesktopWelcomePage.react","PRETestMPNDesktopThreadPage.react","React","ReactRouterDOM"],(function(a,b,c,d,e,f){e.exports=a;var g=b("React");function a(a){var c=a.path,d=a.ActionDelegate;return g.jsx((a=b("ReactRouterDOM")).BrowserRouter,{children:g.jsxs(a.Switch,{children:[g.jsx(a.Route,{render:function(a){return g.jsx(b("MPNDesktopWelcomePage.react"),babelHelpers["extends"]({},a,{ActionDelegate:d}))},exact:!0,path:b("MessagingPluginPathUtils").MPN_PATH.WELCOME}),g.jsx(a.Route,{render:function(a){return g.jsx(b("MPNDesktopITPContinuePage.react"),babelHelpers["extends"]({},a,{ActionDelegate:d}))},exact:!0,path:b("MessagingPluginPathUtils").MPN_PATH.ITPCONTINUE}),g.jsx(a.Route,{render:function(a){return g.jsx(b("PRETestMPNDesktopThreadPage.react"),babelHelpers["extends"]({},a,{ActionDelegate:d}))},exact:!0,path:b("MessagingPluginPathUtils").MPN_PATH.THREAD}),g.jsx(a.Redirect,{to:c})]})})}}),null);
__d("PRETestMPNDesktopWrapper.react",["Arbiter","AsyncRequest","Bootloader","CreateCustomerChatPluginGuestUserMutation","LiveChatMqttClient","LiveChatPluginConstants","LiveChatPluginLoggerUtil","LiveChatPluginUtils","MessagingPluginContext","MessagingPluginGuestUpgradeActions","MessagingPluginPathUtils","MPNConstants","MPNDesktopIcon.react","MPNIdentity","MPNLocalState","MPNNavigation","MPNStorage","MPNUnreadCountBadge.react","MPNXDMessageManager","Plugin","PluginOptin","PRETestMPNDesktopRoute.react","React","ReactDOM","XMNPlatformCustomerChatPluginOpenThreadController"],(function(a,b,c,d,e,f){"use strict";var g=b("React"),h={NONE:0,CREATE_GUEST_SESSION:1,START_NEW_THREAD:2,GUEST_UPGRADE:3,GUEST_UPGRADE_SWITCH_ACCOUNT:4};a=function(a){babelHelpers.inheritsLoose(c,a);function c(c){var d;d=a.call(this,c)||this;d.actionOnInit=h.NONE;d.iconIframeLoaded=!1;d.$2=null;d.initialPath=d.$4();d.props.redirectCommand==b("MPNConstants").MPNRedirect.NEW_GUEST_SESSION?d.actionOnInit=h.CREATE_GUEST_SESSION:d.props.redirectCommand==b("MPNConstants").MPNRedirect.FB_LOG_IN?d.actionOnInit=h.START_NEW_THREAD:d.props.redirectCommand==b("MPNConstants").MPNRedirect.GUEST_UPGRADE?d.actionOnInit=h.GUEST_UPGRADE:d.props.redirectCommand===b("MPNConstants").MPNRedirect.GUEST_UPGRADE_SWITCH_ACCOUNT&&(d.actionOnInit=h.GUEST_UPGRADE_SWITCH_ACCOUNT);d.ActionDelegate={onContinueAsGuest:d.onContinueAsGuest.bind(babelHelpers.assertThisInitialized(d)),openThreadWithCurrentFBUser:d.openThreadWithCurrentFBUser.bind(babelHelpers.assertThisInitialized(d)),openThreadWithInterstitial:d.openThreadWithInterstitial.bind(babelHelpers.assertThisInitialized(d)),onChatInMessenger:function(){},minimize:function(){b("MPNNavigation").minimizePlugin(d.context,!1)},maximize:function(){b("MPNNavigation").maximizePlugin(d.context,!1)}};d.$1=window.name;return d}var d=c.prototype;d.$4=function(){var a=this.props.redirectCommand;return a==b("MPNConstants").MPNRedirect.NEW_GUEST_SESSION||a==b("MPNConstants").MPNRedirect.FB_LOG_IN?b("MessagingPluginPathUtils").MPN_PATH.THREAD:this.props.path};d.componentDidMount=function(){this.$5(),b("MPNXDMessageManager").setupDesktopIframe(this.context.state.alignment),this.$6(),this.$7()};d.componentWillUnmount=function(){this.$3&&window.clearTimeout(this.$3)};d.componentDidUpdate=function(){this.$7()};d.$7=function(){var a=this,c=this.context.state,d=c.optimisticStorageState,e=c.pageID,f=c.pageName;c=c.accessToken;var g=b("MPNIdentity").MPNIdentity.currentUserID();if(this.$2==g||d.chatState===b("MPNLocalState").MPNChatState.CHAT_NOT_STARTED||g==null)return;d=b("MPNIdentity").MPNIdentity.currentUserState();d===b("MPNIdentity").MPNIdentityState.FB&&(b("LiveChatMqttClient").setUp(e,g,null,function(){return a.$2=g}),b("Bootloader").loadModules(["LiveChatPluginAlerts","MercurySyncDeltaHandler"],function(a,c){a.init(g,e,f,new Map(),!1,0),c.getForFBID(g),b("Arbiter").inform("MercurySyncDeltaHandler/initSeqID",{fbid:g,seqID:0})},"PRETestMPNDesktopWrapper.react"));d===b("MPNIdentity").MPNIdentityState.GUEST&&(c!=null&&(b("LiveChatMqttClient").setUp(e,g,null,null,c),this.$2=g))};d.$5=function(){var a=this;b("MPNXDMessageManager").setupIconIframe(this.$1,this.context.state.alignment);b("MPNXDMessageManager").subscribeEvent("plugin_wrapper","message","bubbleFrameLoaded",function(c){try{var d=a.context.state;if(c.data.frameName!=null){d=g.jsx(b("MPNDesktopIcon.react"),{threadColor:d.threadCSSColor,actionDelegate:a.ActionDelegate,pageID:d.pageID,pluginRequestTime:d.serverTime,initialVisibility:d.optimisticStorageState.visibility});var e=parent.frames[c.data.frameName].document.body;b("ReactDOM").render(d,e);a.iconIframeLoaded=!0}if(c.data.unreadCountFrameName!=null){d=g.jsx(b("MPNUnreadCountBadge.react"),{});e=parent.frames[c.data.unreadCountFrameName].document.body;b("ReactDOM").render(d,e)}a.$8()}catch(d){b("LiveChatPluginLoggerUtil").logImpressionExceptionsFromNewUI("tab_load_failure",a.context.state.pageID,"plugin_icon",d.name,d.message,d.stack,JSON.stringify({iconSrc:c.data.iconSrc,unreadSrc:c.data.unreadSrc}))}})};d.$8=function(){var a=this,b=this.context.state,c=b.greetingDialogDelay,d=b.greetingDialogDisplay;b=b.isInitialLoad;if(!b)return;b=!1;switch(d){case"show":case"unset":case"fade":b=c>0;break;case"hide":b=!1;break;default:break}if(!b)return;this.$3=window.setTimeout(function(){a.$9()},c)};d.$9=function(){this.context.state.optimisticStorageState.visibility==="hidden"&&b("MPNNavigation").maximizePlugin(this.context,!0)};d.$6=function(){var a=this;b("MPNXDMessageManager").subscribeEvent("plugin_wrapper","message","CustomerChat.SDK.Called",function(c){var d=a.context.state,e=d.pageID,f=d.greetingDialogDelay,g=d.threadCSSColor,h=d.loggedInGreeting;d=d.loggedOutGreeting;c=b("LiveChatPluginLoggerUtil").EVENTMAP[c.data.event];b("LiveChatPluginLoggerUtil").logImpressionEvents(c,e,JSON.stringify({greetingDialogDelay:f}),g,h,d)});b("MPNXDMessageManager").subscribeEvent("plugin_wrapper","message","updateCustomerChat",function(c){var d=a.context,e=d.state;d=d.dispatchAction;var f=e.loggedInGreeting,g=e.loggedOutGreeting;e=e.refParam;try{c=(c=c.data)==null?void 0:(c=c.message)==null?void 0:c.params;if(c==null)return;c=JSON.parse(c);var h=b("LiveChatPluginUtils").getSanitizedGreetingText(c.logged_in_greeting),i=b("LiveChatPluginUtils").getSanitizedGreetingText(c.logged_out_greeting);d({type:"SDK_UPDATE",loggedInGreeting:(d=h)!=null?d:f,loggedOutGreeting:(h=i)!=null?h:g,refParam:(d=c.ref)!=null?d:e})}catch(a){}});b("MPNXDMessageManager").subscribeEvent("plugin_wrapper","message","CustomerChat.isDialogHidden",function(c){c=((c=c.data.params)==null?void 0:c.is_dialog_hidden)==!0?"hidden":"not-hidden";b("MPNStorage").setVisibility(c);a.context.dispatchAction({type:"UPDATE_DIALOG_VISIBILITY",dialogVisibility:c})})};d.render=function(){this.actionOnInit==h.CREATE_GUEST_SESSION?(this.actionOnInit=h.NONE,this.onContinueAsGuest(function(){b("MPNStorage").clearRedirectCommand()})):this.actionOnInit==h.START_NEW_THREAD?(this.actionOnInit=h.NONE,b("MPNStorage").clearRedirectCommand(),this.openThreadWithCurrentFBUser()):this.actionOnInit==h.GUEST_UPGRADE?(this.actionOnInit=h.NONE,b("MPNStorage").clearRedirectCommand(),b("MessagingPluginGuestUpgradeActions").clearGuestStorage(this.context),b("MessagingPluginGuestUpgradeActions").setPluginStateToUpgradedThread(this.context)):this.actionOnInit==h.GUEST_UPGRADE_SWITCH_ACCOUNT&&(this.actionOnInit=h.NONE,b("MPNStorage").clearRedirectCommand(),b("MPNIdentity").MPNIdentity.subscribeLoggedInUserChanges(function(a,c){a=b("MPNStorage").getFBStorageState();a!=null&&b("MPNStorage").setFBStorageState(babelHelpers["extends"]({},a,{rdr:b("MPNConstants").MPNRedirect.GUEST_UPGRADE}));b("MPNXDMessageManager").reloadPlugin()},250));return this.context.state.optimisticStorageState.visibility=="not-hidden"||this.iconIframeLoaded?g.jsx(b("PRETestMPNDesktopRoute.react"),{path:this.initialPath,ActionDelegate:this.ActionDelegate}):null};d.$10=function(){var a=b("MPNStorage").getFBStorageState(),c=b("MPNIdentity").MPNIdentity.currentUserID();if(a==null||c==null)return;var d={path:b("MPNLocalState").MPNLocalStatePath.THREAD_VIEW,chatState:b("MPNLocalState").MPNChatState.LOGGED_IN_CHAT_STARTED,visibility:"not-hidden"};b("MPNStorage").setFBStorageState(babelHelpers["extends"]({},a,{currentPath:d.path,chatState:d.chatState,userID:c}));b("MPNStorage").setThirdPartyStorageState(d);this.context.dispatchAction({type:"START_CHAT",optimisticStorageState:d})};d.openThreadWithCurrentFBUser=function(){var a=this.context.state,c=a.pageID,d=a.requestID,e=a.refParam,f=a.refererUri;a=a.locale;c=b("XMNPlatformCustomerChatPluginOpenThreadController").getURIBuilder().setFBID("page_id",c).setString("ref",e).setString("referer_uri",f).setString("request_id",d).setString("locale",a).getRequest_LEGACY_UNTYPED(new(b("AsyncRequest"))());c.setAllowCrossPageTransition(!0).setMethod("POST").send();this.$10()};d.openThreadWithInterstitial=function(a){var c=this,d=this.context.state,e=d.pageID;d=d.requestID;new(b("PluginOptin"))("customer_chat").addLoginParams({logged_in:!0,page_id:e,request_id:d,switch_user:!1}).start();b("Arbiter").subscribeOnce(b("Plugin").CONNECT,function(){c.$10(),a!=null&&a()})};d.onContinueAsGuest=function(a){var c=this.context,d=c.state,e=c.dispatchAction,f=d.pageID,g=d.locale,h=d.requestID;b("CreateCustomerChatPluginGuestUserMutation").commit({input:{page_id:f,locale:g}},{onSuccess:function(c){var i,j;i=(i=c.create_customer_chat_plugin_guest_user)==null?void 0:i.session_key;j=(j=c.create_customer_chat_plugin_guest_user)==null?void 0:j.fbid;c=(c=c.create_customer_chat_plugin_guest_user)==null?void 0:c.access_token;if(i!=null&&j!=null&&c!=null){i=b("MPNStorage").getFBStorageState();var k={path:b("MPNLocalState").MPNLocalStatePath.THREAD_VIEW,chatState:b("MPNLocalState").MPNChatState.GUEST_CHAT_STARTED,visibility:"not-hidden",showUpgradePrompt:b("MPNConstants").MPNUpgradePrompt.NOT_SHOWN};if(i!=null){var l=Date.now()+b("LiveChatPluginConstants").GUEST_SESSION_STORAGE_VALIDITY_MS;b("MPNStorage").setFBStorageState(babelHelpers["extends"]({},i,{currentPath:k.path,chatState:k.chatState,userID:j,accessToken:c,expirationTimestamp:l,showUpgradePrompt:b("MPNConstants").MPNUpgradePrompt.NOT_SHOWN}))}b("MPNIdentity").MPNIdentity.changeIdentityToGuest(j,c);e({type:"START_CHAT",optimisticStorageState:k,accessToken:c,guestID:j});i=b("XMNPlatformCustomerChatPluginOpenThreadController").getURIBuilder().setFBID("page_id",f).setString("ref",d.refParam).setString("referer_uri",d.refererUri).setString("request_id",h).setString("access_token",c).setString("locale",g).getRequest_LEGACY_UNTYPED(new(b("AsyncRequest"))());i.setAllowCrossPageTransition(!0).setMethod("POST").send();a(j,c)}},onFailure:function(a){b("MPNStorage").clearFBStorageState(),b("MPNStorage").clearThirdPartyStorageState(),b("MPNXDMessageManager").reloadPlugin()}})};return c}(g.Component);e.exports=a;a.contextType=b("MessagingPluginContext")}),null);
__d("PRETestMPNDesktopRoot",["cx","CometBlueBridgeKeyCommandListener.react","LiveChatPluginErrorBoundary.react","MessagingPluginPathUtils","MessagingPluginStateProvider","MPNConstants","MPNIdentity","MPNLocalState","MPNStorage","MPNXDMessageManager","PRETestMPNDesktopWrapper.react","React","ReactDOM","URI","performanceAbsoluteNow"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=b("React");a=function(){function a(a){var c=a.alignment,d=a.pageID,e=a.container,f=a.serverTime,g=a.pagePassesSentryTest,i=a.hasMessagingPermission,j=a.isMuted,k=a.isPageBlocked,l=a.isBusinessActive,m=a.reloaded,n=a.requestID,o=a.refererUri,p=a.originDomain,q=a.soundURLs,r=a.hasGuestMode,s=a.showUpgradeUpsellPrompt,t=a.appSwitchUri,u=a.upgradeAppSwitchUri,v=a.storedStates,w=a.isComposerDisabled,x=a.hasPersistentMenu,y=a.pageName,z=a.pageProfilePictureUri,A=a.viewerProfilePicureUri,B=a.pageResponsiveness,C=a.isInstantlyResponsive,D=a.refParam,E=a.pageVerifiedStatus,F=a.greetingDialogDelay,G=a.greetingDialogDisplay,H=a.greetingDialogFadeDelay,I=a.loggedInGreeting,J=a.loggedOutGreeting,K=a.threadCSSColor,L=a.locale;a=a.icebreakers;var M=(h||(h=b("performanceAbsoluteNow")))();try{this.$1(c,d,e,f,g,i,j,k,l,m,n,o,p,q,t,u,r,s,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,M,L,a)}catch(a){}}var c=a.prototype;c.$1=function(a,c,d,e,f,g,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O){var P=this,Q=!1;b("MPNStorage").initialize(q,c,o);b("MPNIdentity").MPNIdentity.hasStorageAccess(function(n){b("MPNIdentity").MPNIdentity.init(n);var F=o,I=w;I||(I=P.$2(H,G),b("MPNStorage").setThirdPartyStorageState(I));var M=!1,R,S,T=I.visibility;if(n){b("MPNStorage").isAccessTokenExpired()&&(b("MPNStorage").clearFBStorageState(),I=P.$2(H,G),b("MPNStorage").setThirdPartyStorageState(I));var U=b("MPNStorage").getFBStorageState();if(U!=null&&U.requestID!=null&&U.requestID!=""){var V=U.requestID;(U.rdr==b("MPNConstants").MPNRedirect.NEW_GUEST_SESSION||U.rdr==b("MPNConstants").MPNRedirect.ITP_CONTINUE_SESSION)&&(F=V,b("MPNStorage").initialize(q,c,V))}Q=b("MPNStorage").setInitialStateIfNecessary(!1,T);U=b("MPNStorage").getFBStorageState();if(U!=null){M=U.chatState!=b("MPNLocalState").MPNChatState.CHAT_NOT_STARTED;R=U.accessToken;S=U.userID;T=U.visibility;I={path:U.currentPath,chatState:U.chatState,visibility:U.visibility,showUpgradePrompt:(V=U.showUpgradePrompt)!=null?V:b("MPNConstants").MPNUpgradePrompt.NOT_SHOWN};b("MPNStorage").setThirdPartyStorageState(I)}}U=P.$3(n,w);T=="hidden"&&b("MPNXDMessageManager").updateAppearance(!0,!0,"false","false",null,a,"true",U);b("MPNIdentity").MPNIdentity.subscribeLoggedInUserChanges(function(a,c){b("MPNIdentity").MPNIdentity.currentUserState()!=b("MPNIdentity").MPNIdentityState.GUEST&&(b("MPNStorage").clearFBStorageState(),b("MPNStorage").clearThirdPartyStorageState()),b("MPNXDMessageManager").reloadPlugin()});V={alignment:a,pageID:c,pageName:z,pagePassesSentryTest:f,hasMessagingPermission:g,isMuted:k,isPageBlocked:l,pageProfilePictureUri:A,viewerProfilePicureUri:B,threadCSSColor:L,pageResponsiveness:C,isInstantlyResponsive:D,isComposerDisabled:x,hasPersistentMenu:y,greetingDialogDelay:G,greetingDialogDisplay:H,loggedInGreeting:J,loggedOutGreeting:K,refParam:E,refererUri:p,originDomain:q,appSwitchUri:s,upgradeAppSwitchUri:t,locale:N,isBusinessActive:m,icebreakers:O,initialRequestUri:(i||(i=b("URI"))).getRequestURI(),requestID:F,chatStarted:M,accessToken:R,guestID:S,optimisticStorageState:I,soundURLs:r,isInitialLoad:Q,hasGuestMode:u,showUpgradeUpsellPrompt:v,pluginMountTime:(h||(h=b("performanceAbsoluteNow")))(),serverTime:e,upgradeUpsellPrompt:b("MPNConstants").MPNUpgradePrompt.NOT_SHOWN,messageCount:null,cookieAccessDenied:!1};b("ReactDOM").render(j.jsx(b("LiveChatPluginErrorBoundary.react"),{pageID:c,children:j.jsx(b("CometBlueBridgeKeyCommandListener.react"),{children:j.jsx(b("MessagingPluginStateProvider"),{initialState:V,children:j.jsx("div",{className:"_95ry",children:j.jsx(b("PRETestMPNDesktopWrapper.react"),{path:U,redirectCommand:b("MPNStorage").getRedirectCommand()})})})})}),d)})};c.$2=function(a,c){a=a==="hide"||c>0;return{path:b("MPNLocalState").MPNLocalStatePath.WELCOME_PAGE,chatState:b("MPNLocalState").MPNChatState.CHAT_NOT_STARTED,visibility:a?"hidden":"not-hidden",showUpgradePrompt:b("MPNConstants").MPNUpgradePrompt.NOT_SHOWN}};c.$3=function(a,c){var d=b("MessagingPluginPathUtils").MPN_PATH.WELCOME;if(a){a=b("MPNStorage").getFBStorageState();a!=null&&a.currentPath!=null?(d=b("MessagingPluginPathUtils").MessagingPluginPathUtils.toMobilePath(a.currentPath),b("MPNXDMessageManager").storeThirdPartyState(a.currentPath,a.chatState)):c!=null&&a==null&&b("MPNXDMessageManager").removeThirdPartyState()}else c!=null&&c.path!=null&&(d=b("MessagingPluginPathUtils").MessagingPluginPathUtils.toMobilePath(c.path)),d==b("MessagingPluginPathUtils").MPN_PATH.THREAD&&(d=b("MessagingPluginPathUtils").MPN_PATH.ITPCONTINUE);return d};return a}();e.exports=a}),null);